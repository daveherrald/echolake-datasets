metadata:
  name: excessive-number-of-taskhost-processes
  version: 8.0.0
  description: The following analytic identifies an excessive number of taskhost.exe
    and taskhostex.exe processes running within a short time frame. It leverages data
    from Endpoint Detection and Response (EDR) agents, focusing on process names and
    their counts. This behavior is significant as it is commonly associated with post-exploitation
    tools like Meterpreter and Koadic, which use multiple instances of these processes
    for actions such as discovery and lateral movement. If confirmed malicious, this
    activity
  author: Michael Hart
  tags:
  - anomaly
  - splunk-security-content
  - meterpreter
  mitre_attack:
    techniques:
    - id: T1059
      name: Technique T1059
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059/excessive_distinct_processes_from_windows_temp/windows-xml.log
    description: XmlWinEventLog:Security - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
