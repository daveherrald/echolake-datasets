metadata:
  name: detect-dns-query-to-decommissioned-s3-bucket
  version: 3.0.0
  description: This detection identifies DNS queries to domains that match previously
    decommissioned S3 buckets. This activity is significant because attackers may
    attempt to recreate deleted S3 buckets that were previously public to hijack them
    for malicious purposes. If successful, this could allow attackers to host malicious
    content or exfiltrate data through compromised bucket names that may still be
    referenced by legitimate applications.
  author: Jose Hernandez, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - aws-s3-bucket-security-monitoring
  - data-destruction
  mitre_attack:
    techniques:
    - id: T1485
      name: Technique T1485
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/decommissioned_buckets/cloudtrail.json
    description: cloudtrail - aws:cloudtrail
    format: auto
    schema: raw
    sourcetype: aws:cloudtrail
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/decommissioned_buckets/dns.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
