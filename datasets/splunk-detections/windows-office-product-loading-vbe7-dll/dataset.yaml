metadata:
  name: windows-office-product-loading-vbe7-dll
  version: 4.0.0
  description: The following analytic identifies office documents executing macro
    code. It leverages Sysmon EventCode 7 to detect when processes like WINWORD.EXE
    or EXCEL.EXE load specific DLLs associated with macros (e.g., VBE7.DLL). This
    activity is significant because macros are a common attack vector for delivering
    malicious payloads, such as malware. If confirmed malicious, this could lead to
    unauthorized code execution, data exfiltration, or further compromise of the system.
    Disabling macros by default i
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - spearphishing-attachments
  - trickbot
  - icedid
  mitre_attack:
    techniques:
    - id: T1566.001
      name: Technique T1566.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1566.001/datasets/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
