metadata:
  name: windows-default-rdp-file-creation-by-non-mstsc-process
  version: 1.0.0
  description: This detection monitors the creation or modification of the Default.rdp
    file by non mstsc.exe process, typically found in the user's Documents folder.
    This file is automatically generated or updated by the Remote Desktop Connection
    client (mstsc.exe) when a user initiates an RDP session. It stores connection
    settings such as the last-used hostname, screen size, and other preferences. The
    presence or update of this file strongly suggests that an RDP session has been
    launched from the system. Sinc
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - windows-rdp-artifacts-and-defense-evasion
  mitre_attack:
    techniques:
    - id: T1021.001
      name: Technique T1021.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1021.001/susp_default_rdp_creation/default_rdp_dropped.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
