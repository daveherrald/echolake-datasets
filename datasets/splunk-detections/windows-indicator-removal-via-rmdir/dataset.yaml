metadata:
  name: windows-indicator-removal-via-rmdir
  version: 7.0.0
  description: The following analytic detects the execution of the 'rmdir' command
    with '/s' and '/q' options to delete files and directory trees. This detection
    leverages data from Endpoint Detection and Response (EDR) agents, focusing on
    command-line executions and process metadata. This activity is significant as
    it may indicate malware attempting to remove traces or components during cleanup
    operations. If confirmed malicious, this behavior could allow attackers to eliminate
    forensic evidence, hinder incid
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - darkgate-malware
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1070
      name: Technique T1070
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070/rmdir_delete_files_and_dir/rmdir.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
