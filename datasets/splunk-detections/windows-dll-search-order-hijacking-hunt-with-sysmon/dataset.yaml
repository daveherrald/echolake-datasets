metadata:
  name: windows-dll-search-order-hijacking-hunt-with-sysmon
  version: 11.0.0
  description: The following analytic identifies potential DLL search order hijacking
    or DLL sideloading by detecting known Windows libraries loaded from non-standard
    directories. It leverages Sysmon EventCode 7 to monitor DLL loads and cross-references
    them with a lookup of known hijackable libraries. This activity is significant
    as it may indicate an attempt to execute malicious code by exploiting DLL search
    order vulnerabilities. If confirmed malicious, this could allow attackers to gain
    code execution, esc
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - qakbot
  - windows-defense-evasion-tactics
  - living-off-the-land
  mitre_attack:
    techniques:
    - id: T1574.001
      name: Technique T1574.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.001/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
