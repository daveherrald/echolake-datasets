metadata:
  name: windows-process-injection-wermgr-child-process
  version: 6.0.0
  description: The following analytic identifies a suspicious instance of wermgr.exe
    spawning a child process unrelated to error or fault handling. This detection
    leverages data from Endpoint Detection and Response (EDR) agents, focusing on
    process relationships and command-line executions. This activity is significant
    as it can indicate Qakbot malware, which injects malicious code into wermgr.exe
    to evade detection and execute malicious actions. If confirmed malicious, this
    behavior could allow an attacker to
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - qakbot
  - windows-error-reporting-service-elevation-of-privilege-vulnerability
  mitre_attack:
    techniques:
    - id: T1055
      name: Technique T1055
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/qakbot/qbot_wermgr/sysmon_wermgr.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
