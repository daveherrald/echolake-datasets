metadata:
  name: windows-identify-powershell-web-access-iis-pool
  version: 4.0.0
  description: This analytic detects and analyzes PowerShell Web Access (PSWA) usage
    in Windows environments. It tracks both connection attempts (EventID 4648) and
    successful logons (EventID 4624) associated with PSWA, providing a comprehensive
    view of access patterns. The analytic identifies PSWA's operational status, host
    servers, processes, and connection metrics. It highlights unique target accounts,
    domains accessed, and verifies logon types. This information is crucial for detecting
    potential misuse, suc
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - cisa-aa24-241a
  mitre_attack:
    techniques:
    - id: T1190
      name: Technique T1190
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/pswa/4648_4624_pswa_pool.log
    description: XmlWinEventLog:Security - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
