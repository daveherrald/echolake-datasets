metadata:
  name: getwmiobject-user-account-with-powershell-script-block
  version: 9.0.0
  description: The following analytic detects the execution of the `Get-WmiObject`
    commandlet with the `Win32_UserAccount` parameter via PowerShell Script Block
    Logging (EventCode=4104). This method leverages script block text to identify
    when a list of all local users is being enumerated. This activity is significant
    as it may indicate an adversary or Red Team operation attempting to gather user
    information for situational awareness and Active Directory discovery. If confirmed
    malicious, this could lead to fu
  author: Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - winter-vivern
  - active-directory-discovery
  - malicious-powershell
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    - id: T1087.001
      name: Technique T1087.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/sbl_xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
