metadata:
  name: windows-impair-defense-add-xml-applocker-rules
  version: 7.0.0
  description: The following analytic detects the use of a PowerShell commandlet to
    import an AppLocker XML policy. This behavior is identified by monitoring processes
    that execute the "Import-Module Applocker" and "Set-AppLockerPolicy" commands
    with the "-XMLPolicy" parameter. This activity is significant because it can indicate
    an attempt to disable or bypass security controls, as seen in the Azorult malware.
    If confirmed malicious, this could allow an attacker to disable antivirus products,
    leading to furth
  author: Teoderick Contreras, Splunk
  tags:
  - hunting
  - splunk-security-content
  - azorult
  mitre_attack:
    techniques:
    - id: T1562.001
      name: Technique T1562.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/azorult/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
