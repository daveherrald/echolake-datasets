metadata:
  name: windows-new-service-security-descriptor-set-via-scexe
  version: 4.0.0
  description: The following analytic detects changes in a service security descriptor
    where a new deny ace has been added. It leverages data from Endpoint Detection
    and Response (EDR) agents, specifically searching for any process execution involving
    the "sc.exe" binary with the "sdset" flag targeting any service and adding a dedicated
    deny ace. If confirmed malicious, this could allow an attacker to escalate their
    privileges, blind defenses and more.
  author: Nasreddine Bencherchali, Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - defense-evasion-or-unauthorized-access-via-sddl-tampering
  mitre_attack:
    techniques:
    - id: T1564
      name: Technique T1564
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1564/sc_sdset_tampering/sc_sdset_tampering_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
