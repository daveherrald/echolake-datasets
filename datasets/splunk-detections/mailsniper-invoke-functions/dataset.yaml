metadata:
  name: mailsniper-invoke-functions
  version: 8.0.0
  description: The following analytic detects the execution of known MailSniper PowerShell
    functions on a machine. It leverages PowerShell logs (EventCode 4104) to identify
    specific script block text associated with MailSniper activities. This behavior
    is significant as MailSniper is often used by attackers to harvest sensitive emails
    from compromised Exchange servers. If confirmed malicious, this activity could
    lead to unauthorized access to sensitive email data, credential theft, and further
    compromise of th
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - data-exfiltration
  mitre_attack:
    techniques:
    - id: T1114.001
      name: Technique T1114.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/sbl_xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
