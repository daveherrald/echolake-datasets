metadata:
  name: remote-process-instantiation-via-wmi-and-powershell-script-block
  version: 8.0.0
  description: The following analytic detects the execution of the `Invoke-WmiMethod`
    commandlet with parameters used to start a process on a remote endpoint via WMI,
    leveraging PowerShell Script Block Logging (EventCode=4104). This method identifies
    specific script block text patterns associated with remote process instantiation.
    This activity is significant as it may indicate lateral movement or remote code
    execution attempts by adversaries. If confirmed malicious, this could allow attackers
    to execute arbit
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-lateral-movement
  mitre_attack:
    techniques:
    - id: T1047
      name: Technique T1047
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/lateral_movement/wmi_remote_process_powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
