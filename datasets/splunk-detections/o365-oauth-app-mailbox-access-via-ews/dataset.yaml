metadata:
  name: o365-oauth-app-mailbox-access-via-ews
  version: 7.0.0
  description: The following analytic detects when emails are accessed in Office 365
    Exchange via Exchange Web Services (EWS) using OAuth-authenticated applications.
    It leverages the ClientInfoString field to identify EWS interactions and aggregates
    metrics such as access counts, timing, and client IP addresses, categorized by
    user, ClientAppId, OperationCount, and AppId. Monitoring OAuth applications accessing
    emails through EWS is crucial for identifying potential abuse or unauthorized
    data access. If confir
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - office-365-collection-techniques
  - nobelium-group
  mitre_attack:
    techniques:
    - id: T1114.002
      name: Technique T1114.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.002/o365_oauth_app_ews_mailbox_access/o365_oauth_app_ews_mailbox_access.log
    description: o365 - o365:management:activity
    format: auto
    schema: raw
    sourcetype: o365:management:activity
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
