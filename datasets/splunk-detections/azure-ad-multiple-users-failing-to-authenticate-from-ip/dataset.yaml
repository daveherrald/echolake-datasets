metadata:
  name: azure-ad-multiple-users-failing-to-authenticate-from-ip
  version: 9.0.0
  description: The following analytic detects a single source IP failing to authenticate
    with 30 unique valid users within 5 minutes in Azure Active Directory. It leverages
    Azure AD SignInLogs with error code 50126, indicating invalid passwords. This
    behavior is significant as it may indicate a Password Spraying attack, where an
    adversary attempts to gain initial access or elevate privileges by trying common
    passwords across many accounts. If confirmed malicious, this activity could lead
    to unauthorized access
  author: Mauricio Velazco, Gowthamaraj Rajendran, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1110.003
      name: Technique T1110.003
    - id: T1110.004
      name: Technique T1110.004
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/password_spraying_azuread/azuread_signin.log
    description: Azure AD - azure:monitor:aad
    format: auto
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
