metadata:
  name: windows-multiple-invalid-users-failed-to-authenticate-using-ntlm
  version: 9.0.0
  description: The following analytic detects a single source endpoint failing to
    authenticate with 30 unique invalid users using the NTLM protocol. It leverages
    EventCode 4776 from Domain Controller logs, focusing on error code 0xC0000064,
    which indicates non-existent usernames. This behavior is significant as it may
    indicate a Password Spraying attack, where an adversary attempts to gain initial
    access or elevate privileges. If confirmed malicious, this activity could lead
    to unauthorized access, privilege e
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-password-spraying
  - volt-typhoon
  mitre_attack:
    techniques:
    - id: T1110.003
      name: Technique T1110.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/purplesharp_invalid_users_ntlm_xml/windows-security.log
    description: XmlWinEventLog:Security - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
