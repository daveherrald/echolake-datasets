metadata:
  name: spoolsv-suspicious-loaded-modules
  version: 9.0.0
  description: The following analytic detects the suspicious loading of DLLs by spoolsv.exe,
    potentially indicating PrintNightmare exploitation. It leverages Sysmon EventCode
    7 to identify instances where spoolsv.exe loads multiple DLLs from the Windows
    System32 spool drivers x64 directory. This activity is significant as it may signify
    an attacker exploiting the PrintNightmare vulnerability to execute arbitrary code.
    If confirmed malicious, this could lead to unauthorized code execution, privilege
    escalation,
  author: Mauricio Velazco, Michael Haag, Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - printnightmare-cve-2021-34527
  - black-basta-ransomware
  mitre_attack:
    techniques:
    - id: T1547.012
      name: Technique T1547.012
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.012/printnightmare/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
