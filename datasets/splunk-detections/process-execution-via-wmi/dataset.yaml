metadata:
  name: process-execution-via-wmi
  version: 10.0.0
  description: The following analytic detects the execution of a process by `WmiPrvSE.exe`,
    indicating potential use of WMI (Windows Management Instrumentation) for process
    creation. This detection leverages data from Endpoint Detection and Response (EDR)
    agents, focusing on process and parent process relationships. This activity is
    significant as WMI can be used for lateral movement, remote code execution, or
    persistence by attackers. If confirmed malicious, this could allow an attacker
    to execute arbitrary c
  author: Rico Valdez, Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - suspicious-wmi-use
  mitre_attack:
    techniques:
    - id: T1047
      name: Technique T1047
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1047/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
