metadata:
  name: aws-multiple-failed-mfa-requests-for-user
  version: 7.0.0
  description: The following analytic identifies multiple failed multi-factor authentication
    (MFA) requests to an AWS Console for a single user. It leverages AWS CloudTrail
    logs, specifically the `additionalEventData` field, to detect more than 10 failed
    MFA prompts within 5 minutes. This activity is significant as it may indicate
    an adversary attempting to bypass MFA by bombarding the user with repeated authentication
    requests. If confirmed malicious, this could lead to unauthorized access to the
    AWS environm
  author: Bhavin Patel
  tags:
  - anomaly
  - splunk-security-content
  - aws-identity-and-access-management-account-takeover
  mitre_attack:
    techniques:
    - id: T1586.003
      name: Technique T1586.003
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/aws_failed_mfa/cloudtrail.json
    description: aws_cloudtrail - aws:cloudtrail
    format: auto
    schema: raw
    sourcetype: aws:cloudtrail
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
