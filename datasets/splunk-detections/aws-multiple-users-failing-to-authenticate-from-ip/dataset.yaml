metadata:
  name: aws-multiple-users-failing-to-authenticate-from-ip
  version: 7.0.0
  description: The following analytic identifies a single source IP failing to authenticate
    into the AWS Console with 30 unique valid users within 10 minutes. It leverages
    CloudTrail logs to detect multiple failed login attempts from the same IP address.
    This behavior is significant as it may indicate a Password Spraying attack, where
    an adversary attempts to gain unauthorized access or elevate privileges by trying
    common passwords across many accounts. If confirmed malicious, this activity could
    lead to unaut
  author: Bhavin Patel
  tags:
  - anomaly
  - splunk-security-content
  - aws-identity-and-access-management-account-takeover
  - compromised-user-account
  mitre_attack:
    techniques:
    - id: T1110.003
      name: Technique T1110.003
    - id: T1110.004
      name: Technique T1110.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/aws_mulitple_failed_console_login/aws_cloudtrail.json
    description: aws_cloudtrail - aws:cloudtrail
    format: auto
    schema: raw
    sourcetype: aws:cloudtrail
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
