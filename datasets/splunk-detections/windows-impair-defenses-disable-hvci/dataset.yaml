metadata:
  name: windows-impair-defenses-disable-hvci
  version: 7.0.0
  description: The following analytic detects the disabling of Hypervisor-protected
    Code Integrity (HVCI) by monitoring changes in the Windows registry. It leverages
    data from the Endpoint datamodel, specifically focusing on registry paths and
    values related to HVCI settings. This activity is significant because HVCI helps
    protect the kernel and system processes from tampering by malicious code. If confirmed
    malicious, disabling HVCI could allow attackers to execute unsigned kernel-mode
    code, potentially leadi
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - blacklotus-campaign
  - windows-defense-evasion-tactics
  - windows-registry-abuse
  mitre_attack:
    techniques:
    - id: T1562.001
      name: Technique T1562.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/atomic_red_team/hvci_windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
