metadata:
  name: detect-aws-console-login-by-user-from-new-city
  version: 7.0.0
  description: The following analytic identifies AWS console login events by users
    from a new city within the last hour. It leverages AWS CloudTrail events and compares
    them against a lookup file of previously seen user locations. This activity is
    significant for a SOC as it may indicate unauthorized access or credential compromise,
    especially if the login originates from an unusual location. If confirmed malicious,
    this could lead to unauthorized access to AWS resources, data exfiltration, or
    further exploita
  author: Bhavin Patel, Eric McGinnis Splunk
  tags:
  - hunting
  - splunk-security-content
  - suspicious-aws-login-activities
  - suspicious-cloud-authentication-activities
  - aws-identity-and-access-management-account-takeover
  mitre_attack:
    techniques:
    - id: T1535
      name: Technique T1535
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json
    description: aws_cloudtrail - aws:cloudtrail
    format: auto
    schema: raw
    sourcetype: aws:cloudtrail
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
