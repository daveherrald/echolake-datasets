metadata:
  name: windows-compatibility-telemetry-tampering-through-registry
  version: 4.0.0
  description: This detection identifies suspicious modifications to the Windows Compatibility
    Telemetry registry settings, specifically within the "TelemetryController" registry
    key and "Command" registry value. It leverages data from the Endpoint.Registry
    data model, focusing on registry paths and values indicative of such changes.
    This activity is significant because CompatTelRunner.exe and the "Microsoft Compatibility
    Appraiser" task always run as System and can be used to elevate privileges or
    establish a
  author: Steven Dick
  tags:
  - ttp
  - splunk-security-content
  - windows-persistence-techniques
  mitre_attack:
    techniques:
    - id: T1546
      name: Technique T1546
    - id: T1053.005
      name: Technique T1053.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546/compattelrunner_abuse/compattelrunner_abuse.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
