metadata:
  name: okta-new-api-token-created
  version: 10.0.0
  description: The following analytic detects the creation of a new API token within
    an Okta tenant. It uses OktaIm2 logs ingested via the Splunk Add-on for Okta Identity
    Cloud to identify events where the `system.api_token.create` command is executed.
    This activity is significant because creating a new API token can indicate potential
    account takeover attempts or unauthorized access, allowing an adversary to maintain
    persistence. If confirmed malicious, this could enable attackers to execute API
    calls, access
  author: Michael Haag, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - okta-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1078.001
      name: Technique T1078.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1098.001/okta_new_api_token_created/okta_new_api_token_created.log
    description: Okta - OktaIM2:log
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
