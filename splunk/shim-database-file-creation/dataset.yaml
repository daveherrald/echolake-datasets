metadata:
  name: shim-database-file-creation
  version: 10.0.0
  description: The following analytic detects the creation of shim database files
    (.sdb) in default directories using the sdbinst.exe application. It leverages
    filesystem activity data from the Endpoint.Filesystem data model to identify file
    writes to the Windows\AppPatch\Custom directory. This activity is significant
    because shims can intercept and alter API calls, potentially allowing attackers
    to bypass security controls or execute malicious code. If confirmed malicious,
    this could lead to unauthorized code
  author: David Dorsey, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-persistence-techniques
  mitre_attack:
    techniques:
    - id: T1546.011
      name: Technique T1546.011
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
