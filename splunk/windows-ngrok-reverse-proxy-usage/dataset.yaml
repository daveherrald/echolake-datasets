metadata:
  name: windows-ngrok-reverse-proxy-usage
  version: 9.0.0
  description: The following analytic detects the execution of ngrok.exe on a Windows
    operating system. It leverages data from Endpoint Detection and Response (EDR)
    agents, focusing on process names and command-line arguments. This activity is
    significant because while ngrok is a legitimate tool for creating secure tunnels,
    it is increasingly used by adversaries to bypass network defenses and establish
    reverse proxies. If confirmed malicious, this could allow attackers to exfiltrate
    data, maintain persistence,
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - reverse-network-proxy
  - cisa-aa22-320a
  - cisa-aa24-241a
  mitre_attack:
    techniques:
    - id: T1572
      name: Technique T1572
    - id: T1090
      name: Technique T1090
    - id: T1102
      name: Technique T1102
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1572/ngrok/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
