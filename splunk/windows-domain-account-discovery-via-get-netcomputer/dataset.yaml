metadata:
  name: windows-domain-account-discovery-via-get-netcomputer
  version: 8.0.0
  description: The following analytic detects the execution of the PowerView PowerShell
    cmdlet Get-NetComputer, which is used to query Active Directory for user account
    details such as "samaccountname," "accountexpires," "lastlogon," and more. It
    leverages Event ID 4104 from PowerShell Script Block Logging to identify this
    activity. This behavior is significant as it may indicate an attempt to gather
    user account information, which is often a precursor to further malicious actions.
    If confirmed malicious, this
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - cisa-aa23-347a
  mitre_attack:
    techniques:
    - id: T1087.002
      name: Technique T1087.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087/powerview_get_netuser_preauthnotrequire/get-netuser-not-require-pwh.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
