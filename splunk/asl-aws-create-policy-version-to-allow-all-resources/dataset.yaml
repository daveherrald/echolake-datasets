metadata:
  name: asl-aws-create-policy-version-to-allow-all-resources
  version: 5.0.0
  description: The following analytic identifies the creation of a new AWS IAM policy
    version that allows access to all resources. It detects this activity by analyzing
    AWS CloudTrail logs for the CreatePolicyVersion event with a policy document that
    grants broad permissions. This behavior is significant because it violates the
    principle of least privilege, potentially exposing the environment to misuse or
    abuse. If confirmed malicious, an attacker could gain extensive access to AWS
    resources, leading to unaut
  author: Patrick Bareiss, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-iam-privilege-escalation
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078/aws_create_policy_version/asl_ocsf_cloudtrail.json
    description: aws_asl - aws:asl
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
