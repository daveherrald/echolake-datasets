metadata:
  name: azure-ad-user-immutableid-attribute-updated
  version: 9.0.0
  description: The following analytic identifies the modification of the SourceAnchor
    (ImmutableId) attribute for an Azure Active Directory user. This detection leverages
    Azure AD audit logs, specifically monitoring the "Update user" operation and changes
    to the SourceAnchor attribute. This activity is significant as it is a step in
    setting up an Azure AD identity federation backdoor, allowing an adversary to
    establish persistence. If confirmed malicious, the attacker could impersonate
    any user, bypassing pass
  author: Mauricio Velazco, Gowthamaraj Rajendran, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-persistence
  - hellcat-ransomware
  mitre_attack:
    techniques:
    - id: T1098
      name: Technique T1098
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1098/azure_ad_set_immutableid/azure-audit.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
