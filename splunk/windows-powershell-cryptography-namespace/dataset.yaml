metadata:
  name: windows-powershell-cryptography-namespace
  version: 10.0.0
  description: The following analytic detects suspicious PowerShell script execution
    involving the cryptography namespace via EventCode 4104. It leverages PowerShell
    Script Block Logging to identify scripts using cryptographic functions, excluding
    common hashes like SHA and MD5. This activity is significant as it is often associated
    with malware that decrypts or decodes additional malicious payloads. If confirmed
    malicious, this could allow an attacker to execute further code, escalate privileges,
    or establish
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - asyncrat
  - xworm
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/asyncrat_crypto_pwh_namespace/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
