# Exploit Public Facing Application via Apache Commons Text

**Type:** Anomaly

**Author:** Michael Haag, Splunk

## Description

The following analytic detects attempts to exploit the CVE-2022-42889 vulnerability in the Apache Commons Text Library, known as Text4Shell. It leverages the Web datamodel to identify suspicious HTTP requests containing specific lookup keys (url, dns, script) that can lead to Remote Code Execution (RCE). This activity is significant as it targets a critical vulnerability that can allow attackers to execute arbitrary code on the server. If confirmed malicious, this could lead to full system compromise, data exfiltration, or further lateral movement within the network.

## MITRE ATT&CK

- T1133
- T1190
- T1505.003

## Analytic Stories

- Text4Shell CVE-2022-42889

## Data Sources

- Nginx Access

## Sample Data

- **Source:** nginx:plus:kv
  **Sourcetype:** nginx:plus:kv
  **URL:** https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/text4shell/text4shell_nginx.log


---

*Source: [Splunk Security Content](detections/web/exploit_public_facing_application_via_apache_commons_text.yml)*
