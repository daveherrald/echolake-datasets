metadata:
  name: exploit-public-facing-application-via-apache-commons-text
  version: 7.0.0
  description: The following analytic detects attempts to exploit the CVE-2022-42889
    vulnerability in the Apache Commons Text Library, known as Text4Shell. It leverages
    the Web datamodel to identify suspicious HTTP requests containing specific lookup
    keys (url, dns, script) that can lead to Remote Code Execution (RCE). This activity
    is significant as it targets a critical vulnerability that can allow attackers
    to execute arbitrary code on the server. If confirmed malicious, this could lead
    to full system compr
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - text4shell-cve-2022-42889
  mitre_attack:
    techniques:
    - id: T1133
      name: Technique T1133
    - id: T1190
      name: Technique T1190
    - id: T1505.003
      name: Technique T1505.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/text4shell/text4shell_nginx.log
    description: nginx:plus:kv - nginx:plus:kv
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
