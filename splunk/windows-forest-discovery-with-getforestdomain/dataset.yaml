metadata:
  name: windows-forest-discovery-with-getforestdomain
  version: 7.0.0
  description: The following analytic detects the execution of the `Get-ForestDomain`
    cmdlet, a component of the PowerView toolkit used for Windows domain enumeration.
    It leverages PowerShell Script Block Logging (EventCode=4104) to identify this
    activity. Detecting `Get-ForestDomain` is significant because adversaries and
    Red Teams use it to gather detailed information about Active Directory forest
    and domain configurations. If confirmed malicious, this activity could enable
    attackers to understand the domain
  author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1087.002
      name: Technique T1087.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.002/AD_discovery/windows-powershell-ForestDomain-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
