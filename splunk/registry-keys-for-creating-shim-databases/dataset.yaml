metadata:
  name: registry-keys-for-creating-shim-databases
  version: 14.0.0
  description: The following analytic detects registry activity related to the creation
    of application compatibility shims. It leverages data from the Endpoint.Registry
    data model, specifically monitoring registry paths associated with AppCompatFlags.
    This activity is significant because attackers can use shims to bypass security
    controls, achieve persistence, or escalate privileges. If confirmed malicious,
    this could allow an attacker to maintain long-term access, execute arbitrary code,
    or manipulate applica
  author: Patrick Bareiss, Teoderick Contreras, Splunk, Steven Dick, Bhavin Patel
  tags:
  - ttp
  - splunk-security-content
  - suspicious-windows-registry-activities
  - windows-persistence-techniques
  - windows-registry-abuse
  mitre_attack:
    techniques:
    - id: T1546.011
      name: Technique T1546.011
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.011/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
