metadata:
  name: logon-script-event-trigger-execution
  version: 7.0.0
  description: The following analytic detects the modification of the UserInitMprLogonScript
    registry entry, which is often used by attackers to establish persistence and
    gain privilege escalation upon system boot. It leverages data from the Endpoint.Registry
    data model, focusing on changes to the specified registry path. This activity
    is significant because it is a common technique used by APT groups and malware
    to ensure their payloads execute automatically when the system starts. If confirmed
    malicious, thi
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - data-destruction
  - windows-privilege-escalation
  - hermetic-wiper
  mitre_attack:
    techniques:
    - id: T1037.001
      name: Technique T1037.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1037.001/logonscript_reg/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
