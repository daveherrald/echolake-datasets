metadata:
  name: linux-setuid-using-setcap-utility
  version: 7.0.0
  description: The following analytic detects the execution of the 'setcap' utility
    to enable the SUID bit on Linux systems. It leverages Endpoint Detection and Response
    (EDR) data, focusing on process names and command-line arguments that indicate
    the use of 'setcap' with specific capabilities. This activity is significant because
    setting the SUID bit allows a user to temporarily gain root access, posing a substantial
    security risk. If confirmed malicious, an attacker could escalate privileges,
    execute arbitr
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - linux-privilege-escalation
  - linux-persistence-techniques
  mitre_attack:
    techniques:
    - id: T1548.001
      name: Technique T1548.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.001/linux_setcap/sysmon_linux.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: text
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
