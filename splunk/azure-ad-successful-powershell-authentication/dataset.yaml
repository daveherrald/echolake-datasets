metadata:
  name: azure-ad-successful-powershell-authentication
  version: 9.0.0
  description: The following analytic identifies a successful authentication event
    against an Azure AD tenant using PowerShell cmdlets. This detection leverages
    Azure AD SignInLogs to identify successful logins where the appDisplayName is
    "Microsoft Azure PowerShell." This activity is significant because it is uncommon
    for regular, non-administrative users to authenticate using PowerShell, and it
    may indicate enumeration and discovery techniques by an attacker. If confirmed
    malicious, this activity could allow
  author: Mauricio Velazco, Gowthamaraj Rajendran, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.004/azuread_pws/azure-audit.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
