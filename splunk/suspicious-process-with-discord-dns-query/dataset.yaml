metadata:
  name: suspicious-process-with-discord-dns-query
  version: 10.0.0
  description: The following analytic identifies a process making a DNS query to Discord,
    excluding legitimate Discord application paths. It leverages Sysmon logs with
    Event ID 22 to detect DNS queries containing "discord" in the QueryName field.
    This activity is significant because Discord can be abused by adversaries to host
    and download malicious files, as seen in the WhisperGate campaign. If confirmed
    malicious, this could indicate malware attempting to download additional payloads
    from Discord, potentiall
  author: Teoderick Contreras, Mauricio Velazco, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - data-destruction
  - whispergate
  - pxa-stealer
  mitre_attack:
    techniques:
    - id: T1059.005
      name: Technique T1059.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.005/discord_dnsquery/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
