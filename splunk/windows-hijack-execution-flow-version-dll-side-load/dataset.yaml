metadata:
  name: windows-hijack-execution-flow-version-dll-side-load
  version: 9.0.0
  description: The following analytic detects a process loading a version.dll file
    from a directory other than %windir%\system32 or %windir%\syswow64. This detection
    leverages Sysmon EventCode 7 to identify instances where an unsigned or improperly
    located version.dll is loaded. This activity is significant as it is a common
    technique used in ransomware and APT malware campaigns, including Brute Ratel
    C4, to execute malicious code via DLL side loading. If confirmed malicious, this
    could allow attackers to exec
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - brute-ratel-c4
  - xworm
  - malicious-inno-setup-loader
  mitre_attack:
    techniques:
    - id: T1574.001
      name: Technique T1574.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/brute_ratel/iso_version_dll_campaign/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
