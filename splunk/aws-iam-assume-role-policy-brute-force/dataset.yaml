metadata:
  name: aws-iam-assume-role-policy-brute-force
  version: 6.0.0
  description: The following analytic detects multiple failed attempts to assume an
    AWS IAM role, indicating a potential brute force attack. It leverages AWS CloudTrail
    logs to identify `MalformedPolicyDocumentException` errors with a status of `failure`
    and filters out legitimate AWS services. This activity is significant as repeated
    failures to assume roles can indicate an adversary attempting to guess role names,
    which is a precursor to unauthorized access. If confirmed malicious, this could
    lead to unautho
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-iam-privilege-escalation
  mitre_attack:
    techniques:
    - id: T1580
      name: Technique T1580
    - id: T1110
      name: Technique T1110
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1580/aws_iam_assume_role_policy_brute_force/aws_iam_assume_role_policy_brute_force.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
