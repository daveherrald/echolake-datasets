metadata:
  name: detect-mimikatz-with-powershell-script-block-logging
  version: 11.0.0
  description: The following analytic detects the execution of Mimikatz commands via
    PowerShell by leveraging PowerShell Script Block Logging (EventCode=4104). This
    method captures and logs the full command sent to PowerShell, allowing for the
    identification of suspicious activities such as Pass the Ticket, Pass the Hash,
    and credential dumping. This activity is significant as Mimikatz is a well-known
    tool used for credential theft and lateral movement. If confirmed malicious, this
    could lead to unauthorized a
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - hellcat-ransomware
  - malicious-powershell
  - hermetic-wiper
  mitre_attack:
    techniques:
    - id: T1003
      name: Technique T1003
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/credaccess-powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
