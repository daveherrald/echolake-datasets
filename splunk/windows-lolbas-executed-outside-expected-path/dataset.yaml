metadata:
  name: windows-lolbas-executed-outside-expected-path
  version: 7.0.0
  description: 'The following analytic identifies a LOLBAS process being executed
    outside of it''s expected location.

    Processes being executed outside of expected locations may be an indicator that
    an adversary is attempting to evade defenses or execute malicious code.

    The LOLBAS project documents Windows native binaries that can be abused by threat
    actors to perform tasks like executing malicious code.

    '
  author: Steven Dick
  tags:
  - anomaly
  - splunk-security-content
  - living-off-the-land
  - masquerading---rename-system-utilities
  - windows-defense-evasion-tactics
  mitre_attack:
    techniques:
    - id: T1036.005
      name: Technique T1036.005
    - id: T1218.011
      name: Technique T1218.011
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/cmd_lolbas_usage/cmd_lolbas_usage.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
