metadata:
  name: windows-indirect-command-execution-via-series-of-forfiles
  version: 6.0.0
  description: The following analytic detects excessive usage of the forfiles.exe
    process, which is often indicative of post-exploitation activities. The detection
    leverages data from Endpoint Detection and Response (EDR) agents, focusing on
    process execution logs that include process GUID, process name, and parent process.
    This activity is significant because forfiles.exe can be abused to execute commands
    on multiple files, a technique used by ransomware like Prestige. If confirmed
    malicious, this behavior co
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - windows-post-exploitation
  - prestige-ransomware
  mitre_attack:
    techniques:
    - id: T1202
      name: Technique T1202
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/winpeas/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
