metadata:
  name: suspicious-msbuild-path
  version: 10.0.0
  description: 'The following analytic detects the execution of msbuild.exe from a
    non-standard path. It leverages data from Endpoint Detection and Response (EDR)
    agents, focusing on process execution logs that deviate from typical msbuild.exe
    locations. This activity is significant because msbuild.exe is commonly abused
    by attackers to execute malicious code, and running it from an unusual path can
    indicate an attempt to evade detection. If confirmed malicious, this behavior
    could allow an attacker to execute '
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - trusted-developer-utilities-proxy-execution-msbuild
  - masquerading---rename-system-utilities
  - living-off-the-land
  mitre_attack:
    techniques:
    - id: T1036.003
      name: Technique T1036.003
    - id: T1127.001
      name: Technique T1127.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1127.001/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
