metadata:
  name: mshta-spawning-rundll32-or-regsvr32-process
  version: 10.0.0
  description: The following analytic detects a suspicious mshta.exe process spawning
    rundll32 or regsvr32 child processes. It leverages data from Endpoint Detection
    and Response (EDR) agents, focusing on process GUID, process name, and parent
    process fields. This activity is significant as it is a known technique used by
    malware like Trickbot to load malicious DLLs and execute payloads. If confirmed
    malicious, this behavior could allow attackers to execute arbitrary code, escalate
    privileges, or download addi
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - trickbot
  - icedid
  - living-off-the-land
  mitre_attack:
    techniques:
    - id: T1218.005
      name: Technique T1218.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/trickbot/spear_phish/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
