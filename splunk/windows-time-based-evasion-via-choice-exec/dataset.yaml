metadata:
  name: windows-time-based-evasion-via-choice-exec
  version: 8.0.0
  description: The following analytic detects the use of choice.exe in batch files
    as a delay tactic, a technique observed in SnakeKeylogger malware. It leverages
    data from Endpoint Detection and Response (EDR) agents, focusing on process names
    and command-line executions. This activity is significant as it indicates potential
    time-based evasion techniques used by malware to avoid detection. If confirmed
    malicious, this behavior could allow attackers to execute code stealthily, delete
    malicious files, and pers
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - snake-keylogger
  - 0bj3ctivity-stealer
  mitre_attack:
    techniques:
    - id: T1497.003
      name: Technique T1497.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1497.003/time_delay_using_choice_exe/snakekeylogger_choice.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
