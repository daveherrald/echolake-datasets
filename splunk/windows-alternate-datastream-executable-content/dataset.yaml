metadata:
  name: windows-alternate-datastream-executable-content
  version: 9.0.0
  description: The following analytic detects the writing of data with an IMPHASH
    value to an Alternate Data Stream (ADS) in the NTFS file system. It leverages
    Sysmon Event ID 15 and regex to identify files with a Portable Executable (PE)
    structure. This activity is significant as it may indicate a threat actor staging
    malicious code in hidden areas for persistence or future execution. If confirmed
    malicious, this could allow attackers to execute hidden code, maintain persistence,
    or escalate privileges within
  author: Steven Dick, Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-defense-evasion-tactics
  mitre_attack:
    techniques:
    - id: T1564.004
      name: Technique T1564.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1564.004/ads_abuse/ads_abuse_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
