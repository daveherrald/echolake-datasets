metadata:
  name: azure-ad-multiple-appids-and-useragents-authentication-spike
  version: 10.0.0
  description: The following analytic detects unusual authentication activity in Azure
    AD, specifically when a single user account has over 8 authentication attempts
    using 3+ unique application IDs and 5+ unique user agents within a short period.
    It leverages Azure AD audit logs, focusing on authentication events and using
    statistical thresholds. This behavior is significant as it may indicate an adversary
    probing for MFA requirements. If confirmed malicious, it suggests a compromised
    account, potentially lead
  author: Mauricio Velazco, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1078
      name: Technique T1078
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078/azure_ad_multiple_appids_and_useragents_auth/azure_ad_multiple_appids_and_useragents_auth.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
