metadata:
  name: getadgroup-with-powershell-script-block
  version: 10.0.0
  description: The following analytic detects the execution of the `Get-AdGroup` PowerShell
    cmdlet using PowerShell Script Block Logging (EventCode=4104). This cmdlet is
    used to enumerate all domain groups, which adversaries may exploit for situational
    awareness and Active Directory discovery. Monitoring this activity is crucial
    as it can indicate reconnaissance efforts within the network. If confirmed malicious,
    this behavior could lead to further exploitation, such as privilege escalation
    or lateral movement
  author: Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - scattered-lapsus$-hunters
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1069.002
      name: Technique T1069.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1069.002/AD_discovery/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
