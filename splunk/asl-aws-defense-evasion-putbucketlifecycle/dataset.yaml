metadata:
  name: asl-aws-defense-evasion-putbucketlifecycle
  version: 4.0.0
  description: 'The following analytic detects `PutBucketLifecycle` events in AWS
    CloudTrail logs where a user sets a lifecycle rule for an S3 bucket with an expiration
    period of fewer than three days. This detection leverages CloudTrail logs to identify
    suspicious lifecycle configurations. This activity is significant because attackers
    may use it to delete CloudTrail logs quickly, thereby evading detection and impairing
    forensic investigations. If confirmed malicious, this could allow attackers to
    cover their '
  author: Patrick Bareiss, Splunk
  tags:
  - hunting
  - splunk-security-content
  - aws-defense-evasion
  mitre_attack:
    techniques:
    - id: T1485.001
      name: Technique T1485.001
    - id: T1562.008
      name: Technique T1562.008
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.008/put_bucketlifecycle/asl_ocsf_cloudtrail.json
    description: aws_asl - aws:asl
    format: jsonl
    schema: raw
    sourcetype: aws:asl
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
