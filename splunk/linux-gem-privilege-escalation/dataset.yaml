metadata:
  name: linux-gem-privilege-escalation
  version: 9.0.0
  description: The following analytic detects the execution of the RubyGems utility
    with elevated privileges, specifically when it is used to run system commands
    as root. This detection leverages data from Endpoint Detection and Response (EDR)
    agents, focusing on command-line executions that include "gem open -e" and "sudo".
    This activity is significant because it indicates a potential privilege escalation
    attempt, allowing a user to execute commands as the root user. If confirmed malicious,
    this could lead to
  author: Gowthamaraj Rajendran, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - linux-privilege-escalation
  - linux-living-off-the-land
  mitre_attack:
    techniques:
    - id: T1548.003
      name: Technique T1548.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548/gem/sysmon_linux.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: text
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
