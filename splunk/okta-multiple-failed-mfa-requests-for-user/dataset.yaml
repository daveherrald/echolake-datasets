metadata:
  name: okta-multiple-failed-mfa-requests-for-user
  version: 8.0.0
  description: The following analytic identifies multiple failed multi-factor authentication
    (MFA) requests for a single user within an Okta tenant. It triggers when more
    than 10 MFA attempts fail within 5 minutes, using Okta event logs to detect this
    pattern. This activity is significant as it may indicate an adversary attempting
    to bypass MFA by bombarding the user with repeated authentication requests, a
    technique used by threat actors like Lapsus and APT29. If confirmed malicious,
    this could lead to unauth
  author: Mauricio Velazco, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - okta-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/okta_multiple_failed_mfa_requests/okta_multiple_failed_mfa_requests.log
    description: Okta - OktaIM2:log
    format: text
    schema: raw
    sourcetype: OktaIM2:log
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
