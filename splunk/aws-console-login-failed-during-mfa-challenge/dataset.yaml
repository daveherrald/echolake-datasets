metadata:
  name: aws-console-login-failed-during-mfa-challenge
  version: 7.0.0
  description: The following analytic identifies failed authentication attempts to
    the AWS Console during the Multi-Factor Authentication (MFA) challenge. It leverages
    AWS CloudTrail logs, specifically the `additionalEventData` field, to detect when
    MFA was used but the login attempt still failed. This activity is significant
    as it may indicate an adversary attempting to access an account with compromised
    credentials but being thwarted by MFA. If confirmed malicious, this could suggest
    an ongoing attempt to br
  author: Bhavin Patel, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-identity-and-access-management-account-takeover
  - compromised-user-account
  mitre_attack:
    techniques:
    - id: T1586.003
      name: Technique T1586.003
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/aws_failed_mfa/cloudtrail.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
