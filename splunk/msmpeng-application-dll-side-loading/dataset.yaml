metadata:
  name: msmpeng-application-dll-side-loading
  version: 10.0.0
  description: The following analytic detects the suspicious creation of msmpeng.exe
    or mpsvc.dll in non-default Windows Defender folders. It leverages the Endpoint.Filesystem
    datamodel to identify instances where these files are created outside their expected
    directories. This activity is significant because it is associated with the REvil
    ransomware, which uses DLL side-loading to execute malicious payloads. If confirmed
    malicious, this could lead to ransomware deployment, resulting in data encryption,
    syste
  author: Teoderick Contreras, Splunk, Sanjay Govind
  tags:
  - ttp
  - splunk-security-content
  - ransomware
  - revil-ransomware
  mitre_attack:
    techniques:
    - id: T1574.001
      name: Technique T1574.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets//malware/revil/msmpeng_side/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
