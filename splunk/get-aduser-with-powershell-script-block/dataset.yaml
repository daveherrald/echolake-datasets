metadata:
  name: get-aduser-with-powershell-script-block
  version: 8.0.0
  description: The following analytic detects the execution of the `Get-AdUser` PowerShell
    cmdlet, which is used to enumerate all domain users. It leverages PowerShell Script
    Block Logging (EventCode=4104) to identify instances where this command is executed
    with a filter. This activity is significant as it may indicate an attempt by adversaries
    or Red Teams to gather information about domain users for situational awareness
    and Active Directory discovery. If confirmed malicious, this behavior could lead
    to fur
  author: Teoderick Contreras, Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - active-directory-discovery
  - cisa-aa23-347a
  mitre_attack:
    techniques:
    - id: T1087.002
      name: Technique T1087.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.002/AD_discovery/aduser_powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
