metadata:
  name: windows-modify-registry-authenticationleveloverride
  version: 8.0.0
  description: 'The following analytic detects modifications to the Windows registry
    key "AuthenticationLevelOverride" within the Terminal Server Client settings.
    It leverages data from the Endpoint.Registry datamodel to identify changes where
    the registry value is set to 0x00000000. This activity is significant as it may
    indicate an attempt to override authentication levels for remote connections,
    a tactic used by DarkGate malware for malicious installations. If confirmed malicious,
    this could allow attackers '
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - darkgate-malware
  mitre_attack:
    techniques:
    - id: T1112
      name: Technique T1112
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1112/AuthenticationLevelOverride/auth_sys.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
