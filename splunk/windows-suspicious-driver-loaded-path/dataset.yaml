metadata:
  name: windows-suspicious-driver-loaded-path
  version: 6.0.0
  description: The following analytic detects the loading of drivers from suspicious
    paths, which is a technique often used by malicious software such as coin miners
    (e.g., xmrig). It leverages Sysmon EventCode 6 to identify drivers loaded from
    non-standard directories. This activity is significant because legitimate drivers
    typically reside in specific system directories, and deviations may indicate malicious
    activity. If confirmed malicious, this could allow an attacker to execute code
    at the kernel level, p
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - xmrig
  - cisa-aa22-320a
  - agenttesla
  mitre_attack:
    techniques:
    - id: T1543.003
      name: Technique T1543.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/xmrig_miner/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
