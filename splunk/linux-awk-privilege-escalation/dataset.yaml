metadata:
  name: linux-awk-privilege-escalation
  version: 9.0.0
  description: The following analytic detects the use of the AWK command with elevated
    privileges to execute system commands. It leverages Endpoint Detection and Response
    (EDR) telemetry, specifically monitoring processes that include "sudo," "awk,"
    and "BEGIN*system" in their command lines. This activity is significant because
    it indicates a potential privilege escalation attempt, where a user could gain
    root access by executing commands as the root user. If confirmed malicious, this
    could allow an attacker t
  author: Gowthamaraj Rajendran, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - linux-privilege-escalation
  - linux-living-off-the-land
  mitre_attack:
    techniques:
    - id: T1548.003
      name: Technique T1548.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548/awk/sysmon_linux.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: auto
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
