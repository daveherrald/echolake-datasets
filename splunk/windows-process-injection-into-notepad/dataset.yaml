metadata:
  name: windows-process-injection-into-notepad
  version: 10.0.0
  description: The following analytic detects process injection into Notepad.exe using
    Sysmon EventCode 10. It identifies suspicious GrantedAccess requests (0x40 and
    0x1fffff) to Notepad.exe, excluding common system paths like System32, Syswow64,
    and Program Files. This behavior is often associated with the SliverC2 framework
    by BishopFox. Monitoring this activity is crucial as it may indicate an initial
    payload attempting to execute malicious code within Notepad.exe. If confirmed
    malicious, this could allow a
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - bishopfox-sliver-adversary-emulation-framework
  - earth-alux
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1055.002
      name: Technique T1055.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1055/sliver/T1055_windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
