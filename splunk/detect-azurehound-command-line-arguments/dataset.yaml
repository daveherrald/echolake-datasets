metadata:
  name: detect-azurehound-command-line-arguments
  version: 11.0.0
  description: The following analytic detects the execution of the `Invoke-AzureHound`
    command-line argument, commonly used by the AzureHound tool. It leverages data
    from Endpoint Detection and Response (EDR) agents, focusing on process names and
    command-line executions. This activity is significant because AzureHound is often
    used for reconnaissance in Azure environments, potentially exposing sensitive
    information. If confirmed malicious, this activity could allow an attacker to
    map out Azure Active Directory
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-discovery-techniques
  - compromised-windows-host
  mitre_attack:
    techniques:
    - id: T1069.001
      name: Technique T1069.001
    - id: T1069.002
      name: Technique T1069.002
    - id: T1087.001
      name: Technique T1087.001
    - id: T1087.002
      name: Technique T1087.002
    - id: T1482
      name: Technique T1482
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/sharphound/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
