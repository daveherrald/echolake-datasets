metadata:
  name: monitor-registry-keys-for-print-monitors
  version: 12.0.0
  description: The following analytic detects modifications to the registry key `HKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors`.
    It leverages data from the Endpoint.Registry data model, focusing on events where
    the registry path is modified. This activity is significant because attackers
    can exploit this registry key to load arbitrary .dll files, which will execute
    with elevated SYSTEM permissions and persist after a reboot. If confirmed malicious,
    this could allow attackers to maintain persistence, exe
  author: Teoderick Contreras, Splunk, Steven Dick, Bhavin Patel
  tags:
  - ttp
  - splunk-security-content
  - suspicious-windows-registry-activities
  - windows-persistence-techniques
  - windows-registry-abuse
  mitre_attack:
    techniques:
    - id: T1547.010
      name: Technique T1547.010
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1547.010/atomic_red_team/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
