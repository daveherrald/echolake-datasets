metadata:
  name: disable-etw-through-registry
  version: 11.0.0
  description: The following analytic detects modifications to the registry that disable
    the Event Tracing for Windows (ETW) feature. It leverages data from the Endpoint.Registry
    data model, specifically monitoring changes to the registry path "*\\SOFTWARE\\Microsoft\\.NETFramework\\ETWEnabled"
    with a value set to "0x00000000". This activity is significant because disabling
    ETW can allow attackers to evade detection mechanisms, making it harder for security
    tools to monitor malicious activities. If confirmed m
  author: Teoderick Contreras, Splunk, Steven Dick
  tags:
  - ttp
  - splunk-security-content
  - ransomware
  - cisa-aa23-347a
  - windows-registry-abuse
  mitre_attack:
    techniques:
    - id: T1562.001
      name: Technique T1562.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/ransomware_ttp/data2/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
