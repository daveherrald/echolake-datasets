metadata:
  name: windows-indirect-command-execution-via-forfiles
  version: 7.0.0
  description: The following analytic detects the execution of programs initiated
    by forfiles.exe. This command is typically used to run commands on multiple files,
    often within batch scripts. The detection leverages data from Endpoint Detection
    and Response (EDR) agents, focusing on process creation events where forfiles.exe
    is the parent process. This activity is significant because forfiles.exe can be
    exploited to bypass command line execution protections, making it a potential
    vector for malicious activity
  author: Eric McGinnis, Splunk
  tags:
  - ttp
  - splunk-security-content
  - living-off-the-land
  - windows-post-exploitation
  mitre_attack:
    techniques:
    - id: T1202
      name: Technique T1202
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1202/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
