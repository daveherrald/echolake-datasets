metadata:
  name: azure-ad-external-guest-user-invited
  version: 8.0.0
  description: The following analytic detects the invitation of an external guest
    user within Azure AD. It leverages Azure AD AuditLogs to identify events where
    an external user is invited, using fields such as operationName and initiatedBy.
    Monitoring these invitations is crucial as they can lead to unauthorized access
    if abused. If confirmed malicious, this activity could allow attackers to gain
    access to internal resources, potentially leading to data breaches or further
    exploitation of the environment.
  author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-persistence
  mitre_attack:
    techniques:
    - id: T1136.003
      name: Technique T1136.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1136.003/azure_ad_external_guest_user_invited/azure-audit.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
