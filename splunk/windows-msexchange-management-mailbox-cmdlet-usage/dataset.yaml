metadata:
  name: windows-msexchange-management-mailbox-cmdlet-usage
  version: 8.0.0
  description: The following analytic identifies suspicious Cmdlet usage in Exchange
    Management logs, focusing on commands like New-MailboxExportRequest and New-ManagementRoleAssignment.
    It leverages EventCode 1 and specific Message patterns to detect potential ProxyShell
    and ProxyNotShell abuse. This activity is significant as it may indicate unauthorized
    access or manipulation of mailboxes and roles, which are critical for maintaining
    email security. If confirmed malicious, attackers could export mailbox dat
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - proxyshell
  - blackbyte-ransomware
  - proxynotshell
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/exchange/msexchangemanagement.log
    description: WinEventLog:MSExchange Management - MSExchange:management
    format: text
    schema: raw
    sourcetype: MSExchange:management
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
