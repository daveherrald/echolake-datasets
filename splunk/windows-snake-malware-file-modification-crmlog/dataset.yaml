metadata:
  name: windows-snake-malware-file-modification-crmlog
  version: 6.0.0
  description: The following analytic identifies the creation of a .crmlog file within
    the %windows%\Registration directory, typically with a format of <RANDOM_GUID>.<RANDOM_GUID>.crmlog.
    This detection leverages the Endpoint.Filesystem datamodel to monitor file creation
    events in the specified directory. This activity is significant as it is associated
    with the Snake malware, which uses this file for its operations. If confirmed
    malicious, this could indicate the presence of Snake malware, leading to potentia
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - snake-malware
  mitre_attack:
    techniques:
    - id: T1027
      name: Technique T1027
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/snakemalware/snake_crmlog-windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
