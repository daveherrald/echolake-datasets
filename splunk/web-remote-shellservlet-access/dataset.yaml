metadata:
  name: web-remote-shellservlet-access
  version: 7.0.0
  description: The following analytic identifies attempts to access the Remote ShellServlet
    on a web server, specifically targeting Confluence servers vulnerable to CVE-2023-22518
    and CVE-2023-22515. It leverages web data to detect URLs containing "*plugins/servlet/com.jsos.shell/*"
    with a status code of 200. This activity is significant as it is commonly associated
    with web shells and other malicious behaviors, potentially leading to unauthorized
    command execution. If confirmed malicious, attackers could gain
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - cve-2023-22515-privilege-escalation-vulnerability-confluence-data-center-and-server
  - ghostredirector-iis-module-and-rungan-backdoor
  mitre_attack:
    techniques:
    - id: T1190
      name: Technique T1190
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/confluence/nginx_shellservlet.log
    description: /var/log/nginx/access.log - nginx:plus:kv
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
