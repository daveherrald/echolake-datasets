metadata:
  name: windows-powershell-history-file-deletion
  version: 3.0.0
  description: The following analytic detects the usage of PowerShell to delete its
    command history file, which may indicate an attempt to evade detection by removing
    evidence of executed commands. PowerShell stores command history in ConsoleHost_history.txt
    under the userâ€™s profile directory. Adversaries or malicious scripts may delete
    this file using Remove-Item, del, or similar commands. This detection focuses
    on file deletion events targeting the history file, correlating them with recent
    PowerShell activi
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - medusa-ransomware
  mitre_attack:
    techniques:
    - id: T1059.003
      name: Technique T1059.003
    - id: T1070.003
      name: Technique T1070.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1070.003/ConsoleHost_History_deletion/HistorySavePath_powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
