metadata:
  name: get-domainuser-with-powershell-script-block
  version: 9.0.0
  description: The following analytic detects the execution of the `Get-DomainUser`
    cmdlet using PowerShell Script Block Logging (EventCode=4104). This cmdlet is
    part of PowerView, a tool often used for domain enumeration. The detection leverages
    PowerShell operational logs to identify instances where this command is executed.
    Monitoring this activity is crucial as it may indicate an adversary's attempt
    to gather information about domain users, which is a common step in Active Directory
    Discovery. If confirmed
  author: Teoderick Contreras, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  - cisa-aa23-347a
  mitre_attack:
    techniques:
    - id: T1087.002
      name: Technique T1087.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.002/AD_discovery/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
