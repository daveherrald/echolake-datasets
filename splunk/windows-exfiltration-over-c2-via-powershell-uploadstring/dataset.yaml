metadata:
  name: windows-exfiltration-over-c2-via-powershell-uploadstring
  version: 8.0.0
  description: The following analytic identifies potential data exfiltration using
    the PowerShell `net.webclient` command with the `UploadString` method. It leverages
    PowerShell Script Block Logging to detect instances where this command is executed.
    This activity is significant as it may indicate an attempt to upload sensitive
    data, such as desktop screenshots or files, to an external or internal URI, often
    associated with malware like Winter-Vivern. If confirmed malicious, this could
    lead to unauthorized dat
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - apt37-rustonotto-and-fadestealer
  - winter-vivern
  mitre_attack:
    techniques:
    - id: T1041
      name: Technique T1041
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/winter-vivern/pwh_uploadstring/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
