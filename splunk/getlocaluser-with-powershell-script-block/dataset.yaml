metadata:
  name: getlocaluser-with-powershell-script-block
  version: 9.0.0
  description: The following analytic detects the execution of the `Get-LocalUser`
    PowerShell commandlet using PowerShell Script Block Logging (EventCode=4104).
    This commandlet lists all local users on a system. The detection leverages script
    block text from PowerShell logs to identify this activity. Monitoring this behavior
    is significant as adversaries and Red Teams may use it to enumerate local users
    for situational awareness and Active Directory discovery. If confirmed malicious,
    this activity could lead t
  author: Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - active-directory-discovery
  - malicious-powershell
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    - id: T1087.001
      name: Technique T1087.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.001/AD_discovery/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
