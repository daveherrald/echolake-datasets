metadata:
  name: getdomaingroup-with-powershell-script-block
  version: 9.0.0
  description: The following analytic detects the execution of the `Get-DomainGroup`
    cmdlet using PowerShell Script Block Logging (EventCode=4104). This cmdlet, part
    of the PowerView tool, is used to enumerate domain groups within a Windows domain.
    The detection leverages script block text to identify this specific command. Monitoring
    this activity is crucial as it may indicate an adversary or Red Team performing
    reconnaissance to gain situational awareness and map out Active Directory structures.
    If confirmed
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1069.002
      name: Technique T1069.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/domaingroup.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
