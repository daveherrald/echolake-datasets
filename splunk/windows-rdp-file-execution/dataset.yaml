metadata:
  name: windows-rdp-file-execution
  version: 6.0.0
  description: The following analytic detects when a Windows RDP client attempts to
    execute an RDP file from a temporary directory, downloads directory, or Outlook
    directories. This detection is significant as it can indicate an attempt for an
    adversary to deliver a .rdp file, which may be leveraged by attackers to control
    or exfiltrate data. If confirmed malicious, this activity could lead to unauthorized
    access, data theft, or further lateral movement within the network.
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - spearphishing-attachments
  - windows-rdp-artifacts-and-defense-evasion
  - interlock-ransomware
  mitre_attack:
    techniques:
    - id: T1598.002
      name: Technique T1598.002
    - id: T1021.001
      name: Technique T1021.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1598.002/rdp/mstsc_rdpfile-windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
