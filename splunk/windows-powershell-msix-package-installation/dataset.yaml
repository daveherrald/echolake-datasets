metadata:
  name: windows-powershell-msix-package-installation
  version: 2.0.0
  description: The following analytic detects the execution of PowerShell commands
    to install unsigned AppX packages using Add-AppxPackage or Add-AppPackage cmdlets
    with the -AllowUnsigned flag. This detection leverages PowerShell Script Block
    Logging (EventCode=4104) to capture the full command content. This activity is
    significant as adversaries may use unsigned AppX packages to install malicious
    applications, bypass security controls, or establish persistence. If confirmed
    malicious, this could allow attack
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - malicious-powershell
  - msix-package-abuse
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    - id: T1547.001
      name: Technique T1547.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1553.005/msix_unsigned/windows-powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
