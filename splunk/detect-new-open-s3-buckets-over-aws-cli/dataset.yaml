metadata:
  name: detect-new-open-s3-buckets-over-aws-cli
  version: 6.0.0
  description: 'The following analytic detects the creation of open/public S3 buckets
    via the AWS CLI. It leverages AWS CloudTrail logs to identify events where a user
    has set bucket permissions to allow access to "AuthenticatedUsers" or "AllUsers."
    This activity is significant because open S3 buckets can expose sensitive data
    to unauthorized users, leading to data breaches. If confirmed malicious, an attacker
    could gain unauthorized access to potentially sensitive information stored in
    the S3 bucket, posing a '
  author: Patrick Bareiss, Splunk
  tags:
  - ttp
  - splunk-security-content
  - suspicious-aws-s3-activities
  mitre_attack:
    techniques:
    - id: T1530
      name: Technique T1530
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1530/aws_s3_public_bucket/aws_cloudtrail_events.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
