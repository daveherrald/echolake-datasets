metadata:
  name: windows-credentials-from-password-stores-creation
  version: 8.0.0
  description: The following analytic detects the execution of the Windows OS tool
    cmdkey.exe, which is used to create stored usernames, passwords, or credentials.
    This detection leverages data from Endpoint Detection and Response (EDR) agents,
    focusing on process execution logs and command-line arguments. This activity is
    significant because cmdkey.exe is often abused by post-exploitation tools and
    malware, such as Darkgate, to gain unauthorized access. If confirmed malicious,
    this behavior could allow attack
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-windows-host
  - darkgate-malware
  - netsupport-rmm-tool-abuse
  mitre_attack:
    techniques:
    - id: T1555
      name: Technique T1555
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1555/cmdkey_create_credential_store/cmdkey_gen_sys.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
