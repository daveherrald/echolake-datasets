metadata:
  name: linux-ngrok-reverse-proxy-usage
  version: 8.0.0
  description: The following analytic detects the use of Ngrok on a Linux operating
    system. It leverages data from Endpoint Detection and Response (EDR) agents, focusing
    on process names and command-line arguments associated with Ngrok. This activity
    is significant because Ngrok can be used by adversaries to establish reverse proxies,
    potentially bypassing network defenses. If confirmed malicious, this could allow
    attackers to create persistent, unauthorized access channels, facilitating data
    exfiltration or f
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - reverse-network-proxy
  mitre_attack:
    techniques:
    - id: T1572
      name: Technique T1572
    - id: T1090
      name: Technique T1090
    - id: T1102
      name: Technique T1102
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1572/ngrok/ngrok_linux-sysmon.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: text
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
