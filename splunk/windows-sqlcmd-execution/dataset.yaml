metadata:
  name: windows-sqlcmd-execution
  version: 4.0.0
  description: This detection identifies potentially suspicious usage of sqlcmd.exe,
    focusing on command patterns that may indicate data exfiltration, reconnaissance,
    or malicious database operations. The detection looks for both short-form (-X)
    and long-form (--flag) suspicious parameter combinations, which have been observed
    in APT campaigns targeting high-value organizations. For example, threat actors
    like CL-STA-0048 have been known to abuse sqlcmd.exe for data theft and exfiltration
    from compromised MSSQ
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - sql-server-abuse
  - ghostredirector-iis-module-and-rungan-backdoor
  mitre_attack:
    techniques:
    - id: T1059.003
      name: Technique T1059.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.003/atomic_red_team/sqlcmd_windows_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
