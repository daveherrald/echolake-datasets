metadata:
  name: linux-unix-shell-enable-all-sysrq-functions
  version: 7.0.0
  description: The following analytic detects the execution of a command to enable
    all SysRq functions on a Linux system, a technique associated with the AwfulShred
    malware. It leverages Endpoint Detection and Response (EDR) data to identify processes
    executing the command to pipe bitmask '1' to /proc/sys/kernel/sysrq. This activity
    is significant as it can indicate an attempt to manipulate kernel system requests,
    which is uncommon and potentially malicious. If confirmed, this could allow an
    attacker to reboot
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - awfulshred
  - data-destruction
  mitre_attack:
    techniques:
    - id: T1059.004
      name: Technique T1059.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/awfulshred/test2/sysmon_linux.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: auto
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
