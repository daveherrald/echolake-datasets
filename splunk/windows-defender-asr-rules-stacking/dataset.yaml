metadata:
  name: windows-defender-asr-rules-stacking
  version: 6.0.0
  description: The following analytic identifies security events from Microsoft Defender,
    focusing on Exploit Guard and Attack Surface Reduction (ASR) features. It detects
    Event IDs 1121, 1126, 1131, and 1133 for blocked operations, and Event IDs 1122,
    1125, 1132, and 1134 for audit logs. Event ID 1129 indicates user overrides, while
    Event ID 5007 signals configuration changes. This detection uses a lookup to correlate
    ASR rule GUIDs with descriptive names. Monitoring these events is crucial for
    identifying un
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - windows-attack-surface-reduction
  mitre_attack:
    techniques:
    - id: T1566.001
      name: Technique T1566.001
    - id: T1566.002
      name: Technique T1566.002
    - id: T1059
      name: Technique T1059
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059/defender/asr_defender_operational.log
    description: WinEventLog:Microsoft-Windows-Windows Defender/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
