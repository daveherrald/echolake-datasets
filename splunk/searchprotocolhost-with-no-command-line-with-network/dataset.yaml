metadata:
  name: searchprotocolhost-with-no-command-line-with-network
  version: 12.0.0
  description: The following analytic detects instances of searchprotocolhost.exe
    running without command line arguments but with an active network connection.
    This behavior is identified using Endpoint Detection and Response (EDR) telemetry,
    focusing on process execution and network traffic data. It is significant because
    searchprotocolhost.exe typically runs with specific command line arguments, and
    deviations from this norm can indicate malicious activity, such as Cobalt Strike
    usage. If confirmed malicious
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - graceful-wipe-out-attack
  - cobalt-strike
  - compromised-windows-host
  mitre_attack:
    techniques:
    - id: T1055
      name: Technique T1055
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1055/cobalt_strike/windows-sysmon_searchprotocolhost.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
