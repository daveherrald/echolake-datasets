metadata:
  name: detect-certipy-file-modifications
  version: 7.0.0
  description: The following analytic detects the use of the Certipy tool to enumerate
    Active Directory Certificate Services (AD CS) environments by identifying unique
    file modifications. It leverages endpoint process and filesystem data to spot
    the creation of files with specific names or extensions associated with Certipy's
    information gathering and exfiltration activities. This activity is significant
    as it indicates potential reconnaissance and data exfiltration efforts by an attacker.
    If confirmed malicio
  author: Steven Dick
  tags:
  - ttp
  - splunk-security-content
  - windows-certificate-services
  - data-exfiltration
  - ingress-tool-transfer
  mitre_attack:
    techniques:
    - id: T1649
      name: Technique T1649
    - id: T1560
      name: Technique T1560
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1649/certify_abuse/certify_esc1_abuse_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
