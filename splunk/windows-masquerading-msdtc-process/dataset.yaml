metadata:
  name: windows-masquerading-msdtc-process
  version: 7.0.0
  description: 'The following analytic identifies the execution of msdtc.exe with
    specific command-line parameters (-a or -b), which are indicative of the PlugX
    malware. This detection leverages data from Endpoint Detection and Response (EDR)
    agents, focusing on process names and command-line arguments. This activity is
    significant because PlugX uses these parameters to masquerade its malicious operations
    within legitimate processes, making it harder to detect. If confirmed malicious,
    this behavior could allow '
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-windows-host
  - plugx
  mitre_attack:
    techniques:
    - id: T1036
      name: Technique T1036
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1036/msdtc_process_param/msdtc_a_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
