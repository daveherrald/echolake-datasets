metadata:
  name: windows-msiexec-dllregisterserver
  version: 10.0.0
  description: The following analytic detects the execution of msiexec.exe with the
    /y switch parameter, which enables the loading of DLLRegisterServer. This detection
    leverages data from Endpoint Detection and Response (EDR) agents, focusing on
    process command-line arguments and parent-child process relationships. This activity
    is significant because it can indicate an attempt to register malicious DLLs,
    potentially leading to code execution or persistence on the system. If confirmed
    malicious, this could all
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-system-binary-proxy-execution-msiexec
  - water-gamayun
  mitre_attack:
    techniques:
    - id: T1218.007
      name: Technique T1218.007
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.007/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
