metadata:
  name: schedule-task-with-rundll32-command-trigger
  version: 7.0.0
  description: The following analytic detects the creation of scheduled tasks in Windows
    that use the rundll32 command. It leverages Windows Security EventCode 4698, which
    logs the creation of scheduled tasks, and filters for tasks executed via rundll32.
    This activity is significant as it is a common technique used by malware, such
    as TrickBot, to persist in an environment or deliver additional payloads. If confirmed
    malicious, this could lead to data theft, ransomware deployment, or other damaging
    outcomes. I
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-persistence-techniques
  - living-off-the-land
  - icedid
  mitre_attack:
    techniques:
    - id: T1053
      name: Technique T1053
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/trickbot/tasksched/windows-security.log
    description: WinEventLog:Security - WinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
