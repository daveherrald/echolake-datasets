metadata:
  name: windows-command-and-scripting-interpreter-path-traversal-exec
  version: 9.0.0
  description: The following analytic detects path traversal command-line execution,
    often used in malicious documents to execute code via msdt.exe for defense evasion.
    It leverages Endpoint Detection and Response (EDR) data, focusing on specific
    patterns in process paths. This activity is significant as it can indicate an
    attempt to bypass security controls and execute unauthorized code. If confirmed
    malicious, this behavior could lead to code execution, privilege escalation, or
    persistence within the environ
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - microsoft-support-diagnostic-tool-vulnerability-cve-2022-30190
  - compromised-windows-host
  - windows-defense-evasion-tactics
  mitre_attack:
    techniques:
    - id: T1059
      name: Technique T1059
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059/path_traversal/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
