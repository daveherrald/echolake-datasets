metadata:
  name: powershell-processing-stream-of-data
  version: 13.0.0
  description: The following analytic detects suspicious PowerShell script execution
    involving compressed stream data processing, identified via EventCode 4104. It
    leverages PowerShell Script Block Logging to flag scripts using `IO.Compression`,
    `IO.StreamReader`, or decompression methods. This activity is significant as it
    often indicates obfuscated PowerShell or embedded .NET/binary execution, which
    are common tactics for evading detection. If confirmed malicious, this behavior
    could allow attackers to execu
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - hellcat-ransomware
  - malicious-powershell
  - medusa-ransomware
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/streamreader.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
