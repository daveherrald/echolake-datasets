metadata:
  name: suspicious-process-dns-query-known-abuse-web-services
  version: 14.0.0
  description: The following analytic detects a suspicious process making DNS queries
    to known, abused text-paste web services, VoIP, instant messaging, and digital
    distribution platforms. It leverages Sysmon EventID 22 logs to identify queries
    from processes like cmd.exe, powershell.exe, and others. This activity is significant
    as it may indicate an attempt to download malicious files, a common initial access
    technique. If confirmed malicious, this could lead to unauthorized code execution,
    data exfiltration,
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - snake-keylogger
  - meduza-stealer
  - malicious-inno-setup-loader
  mitre_attack:
    techniques:
    - id: T1059.005
      name: Technique T1059.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/remcos/remcos_pastebin_download/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
