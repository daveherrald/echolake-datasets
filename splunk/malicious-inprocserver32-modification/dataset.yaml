metadata:
  name: malicious-inprocserver32-modification
  version: 8.0.0
  description: The following analytic detects a process modifying the registry with
    a known malicious CLSID under InProcServer32. It leverages data from Endpoint
    Detection and Response (EDR) agents, focusing on registry modifications within
    the HKLM or HKCU Software Classes CLSID paths. This activity is significant as
    it may indicate an attempt to load a malicious DLL, potentially leading to code
    execution. If confirmed malicious, this could allow an attacker to persist in
    the environment, execute arbitrary co
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - suspicious-regsvr32-activity
  - remcos
  mitre_attack:
    techniques:
    - id: T1218.010
      name: Technique T1218.010
    - id: T1112
      name: Technique T1112
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/remcos/remcos/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
