metadata:
  name: windows-find-domain-organizational-units-with-getdomainou
  version: 7.0.0
  description: The following analytic detects the execution of the `Get-DomainOU`
    cmdlet, a part of the PowerView toolkit used for Windows domain enumeration. It
    leverages PowerShell Script Block Logging (EventCode=4104) to identify this activity.
    Detecting `Get-DomainOU` usage is significant as adversaries may use it to gather
    information about organizational units within Active Directory, which can facilitate
    lateral movement or privilege escalation. If confirmed malicious, this activity
    could allow attacker
  author: Gowthamaraj Rajendran, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1087.002
      name: Technique T1087.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.002/AD_discovery/windows-powershell-DomainOU-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
