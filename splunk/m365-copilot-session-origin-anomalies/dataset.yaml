metadata:
  name: m365-copilot-session-origin-anomalies
  version: 1.0.0
  description: Detects M365 Copilot users accessing from multiple geographic locations
    to identify potential account compromise, credential sharing, or impossible travel
    patterns. The detection aggregates M365 Copilot Graph API events per user, calculating
    distinct cities and countries accessed, unique IP addresses, and the observation
    timeframe to compute a locations-per-day metric that measures geographic mobility.
    Users accessing Copilot from more than one city (cities_count > 1) are flagged
    and sorted by c
  author: Rod Soto
  tags:
  - anomaly
  - splunk-security-content
  - suspicious-microsoft-365-copilot-activities
  mitre_attack:
    techniques:
    - id: T1078
      name: Technique T1078
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/m365_copilot/m365_copilot_access.log
    description: AuditLogs.SignIns - o365:graph:api
    format: auto
    schema: raw
    sourcetype: o365:graph:api
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
