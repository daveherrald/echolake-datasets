metadata:
  name: o365-block-user-consent-for-risky-apps-disabled
  version: 6.0.0
  description: The following analytic detects when the "risk-based step-up consent"
    security setting in Microsoft 365 is disabled. It monitors Azure Active Directory
    logs for the "Update authorization policy" operation, specifically changes to
    the "AllowUserConsentForRiskyApps" setting. This activity is significant because
    disabling this feature can expose the organization to OAuth phishing threats,
    allowing users to grant consent to malicious applications. If confirmed malicious,
    attackers could gain unauthor
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - office-365-account-takeover
  mitre_attack:
    techniques:
    - id: T1562
      name: Technique T1562
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562/o365_disable_blockconsent_for_riskapps/o365_disable_blockconsent_for_riskapps.log
    description: O365 - o365:management:activity
    format: auto
    schema: raw
    sourcetype: o365:management:activity
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
