metadata:
  name: windows-system-file-on-disk
  version: 7.0.0
  description: The following analytic detects the creation of new .sys files on disk.
    It leverages the Endpoint.Filesystem data model to identify and log instances
    where .sys files are written to the filesystem. This activity is significant because
    .sys files are often used as kernel mode drivers, and their unauthorized creation
    can indicate malicious activity such as rootkit installation. If confirmed malicious,
    this could allow an attacker to gain kernel-level access, leading to full system
    compromise, persi
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - cisa-aa22-264a
  - windows-drivers
  - crypto-stealer
  mitre_attack:
    techniques:
    - id: T1068
      name: Technique T1068
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1068/drivers/sysmon_sys_filemod.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
