metadata:
  name: azure-ad-concurrent-sessions-from-different-ips
  version: 11.0.0
  description: The following analytic detects an Azure AD account with concurrent
    sessions originating from multiple unique IP addresses within a 5-minute window.
    It leverages Azure Active Directory NonInteractiveUserSignInLogs to identify this
    behavior by analyzing successful authentication events and counting distinct source
    IPs. This activity is significant as it may indicate session hijacking, where
    an attacker uses stolen session cookies to access corporate resources from a different
    location. If confirme
  author: Mauricio Velazco, Bhavin Patel, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-user-account
  - azure-active-directory-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1185
      name: Technique T1185
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1185/azure_ad_concurrent_sessions_from_different_ips/azuread.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
