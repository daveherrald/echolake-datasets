metadata:
  name: dns-query-length-with-high-standard-deviation
  version: 12.0.0
  description: 'The following analytic identifies DNS queries with unusually large
    lengths by computing the standard deviation of query lengths and filtering those
    exceeding two times the standard deviation. It leverages DNS query data from the
    Network_Resolution data model, focusing on the length of the domain names being
    resolved. This activity is significant as unusually long DNS queries can indicate
    data exfiltration or command-and-control communication attempts. If confirmed
    malicious, this activity could '
  author: Bhavin Patel, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - hidden-cobra-malware
  - suspicious-dns-traffic
  - command-and-control
  mitre_attack:
    techniques:
    - id: T1048.003
      name: Technique T1048.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1071.004/long_dns_query/dns-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
