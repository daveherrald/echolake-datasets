metadata:
  name: linux-auditd-doas-conf-file-creation
  version: 8.0.0
  description: 'The following analytic detects the creation of the doas.conf file
    on a Linux host.

    This file is used by the doas utility to allow standard users to perform tasks
    as root, similar to sudo.

    The detection leverages Linux Auditd data, focusing on the creation of the doas.conf
    file.

    This activity is significant because it can indicate an attempt to gain elevated
    privileges, potentially by an adversary. If confirmed malicious, this could allow
    an attacker to execute commands with root commands with ro'
  author: Teoderick Contreras, Nasreddine Bencherchali, Splunk
  tags:
  - ttp
  - splunk-security-content
  - linux-privilege-escalation
  - linux-persistence-techniques
  - compromised-linux-host
  mitre_attack:
    techniques:
    - id: T1548.003
      name: Technique T1548.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.003/auditd_path_cwd_doas_conf/path_doas.log
    description: auditd - auditd
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
