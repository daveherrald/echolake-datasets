metadata:
  name: windows-powershell-scheduletask
  version: 9.0.0
  description: The following analytic detects potential malicious activities involving
    PowerShell's task scheduling cmdlets. It leverages PowerShell Script Block Logging
    (EventCode 4104) to identify unusual or suspicious use of cmdlets like 'New-ScheduledTask'
    and 'Set-ScheduledTask'. This activity is significant as attackers often use these
    cmdlets for persistence and remote execution of malicious code. If confirmed malicious,
    this could allow attackers to maintain access, deliver additional payloads, or
    exec
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - scheduled-tasks
  - scattered-spider
  mitre_attack:
    techniques:
    - id: T1053.005
      name: Technique T1053.005
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/atomic_red_team/pwsh_scheduledtask.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
