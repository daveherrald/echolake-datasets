metadata:
  name: suspicious-mshta-spawn
  version: 9.0.0
  description: 'The following analytic detects the spawning of mshta.exe by wmiprvse.exe
    or svchost.exe. This behavior is identified using Endpoint Detection and Response
    (EDR) data, focusing on process creation events where the parent process is either
    wmiprvse.exe or svchost.exe. This activity is significant as it may indicate the
    use of a DCOM object to execute malicious scripts via mshta.exe, a common tactic
    in sophisticated attacks. If confirmed malicious, this could allow an attacker
    to execute arbitrary '
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - suspicious-mshta-activity
  - living-off-the-land
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1218.005
      name: Technique T1218.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.005/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
