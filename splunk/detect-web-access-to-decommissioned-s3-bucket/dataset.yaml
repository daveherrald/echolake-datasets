metadata:
  name: detect-web-access-to-decommissioned-s3-bucket
  version: 2.0.0
  description: This detection identifies web requests to domains that match previously
    decommissioned S3 buckets through web proxy logs. This activity is significant
    because attackers may attempt to access or recreate deleted S3 buckets that were
    previously public to hijack them for malicious purposes. If successful, this could
    allow attackers to host malicious content or exfiltrate data through compromised
    bucket names that may still be referenced by legitimate applications.
  author: Jose Hernandez, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - aws-s3-bucket-security-monitoring
  - data-destruction
  mitre_attack:
    techniques:
    - id: T1485
      name: Technique T1485
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/decommissioned_buckets/cloudtrail.json
    description: cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
    sourcetype: aws:cloudtrail
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1485/decommissioned_buckets/web_cloudfront_access.log
    description: aws_cloudfront_accesslogs - aws:cloudfront:accesslogs
    format: text
    schema: raw
    sourcetype: aws:cloudfront:accesslogs
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
