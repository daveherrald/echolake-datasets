metadata:
  name: asl-aws-detect-users-creating-keys-with-encrypt-policy-without-mfa
  version: 3.0.0
  description: 'The following analytic detects the creation of AWS KMS keys with an
    encryption policy accessible to everyone, including external entities. It leverages
    AWS CloudTrail logs from Amazon Security Lake to identify `CreateKey` or `PutKeyPolicy`
    events where the `kms:Encrypt` action is granted to all principals. This activity
    is significant as it may indicate a compromised account, allowing an attacker
    to misuse the encryption key to target other organizations. If confirmed malicious,
    this could lead '
  author: Patrick Bareiss, Splunk
  tags:
  - ttp
  - splunk-security-content
  - ransomware-cloud
  mitre_attack:
    techniques:
    - id: T1486
      name: Technique T1486
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1486/aws_kms_key/asl_ocsf_cloudtrail.json
    description: aws_asl - aws:asl
    format: jsonl
    schema: raw
    sourcetype: aws:asl
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
