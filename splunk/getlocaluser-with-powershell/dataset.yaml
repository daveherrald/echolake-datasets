metadata:
  name: getlocaluser-with-powershell
  version: 7.0.0
  description: The following analytic detects the execution of `powershell.exe` with
    the `Get-LocalUser` commandlet, which is used to query local user accounts. This
    detection leverages data from Endpoint Detection and Response (EDR) agents, focusing
    on process names and command-line arguments. Monitoring this activity is significant
    because adversaries and Red Teams may use it to enumerate local users for situational
    awareness and Active Directory discovery. If confirmed malicious, this activity
    could allow a
  author: Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1087.001
      name: Technique T1087.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.001/AD_discovery/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
