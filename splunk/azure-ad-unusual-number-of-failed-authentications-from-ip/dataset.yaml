metadata:
  name: azure-ad-unusual-number-of-failed-authentications-from-ip
  version: 9.0.0
  description: The following analytic identifies a single source IP failing to authenticate
    with multiple valid users, potentially indicating a Password Spraying attack against
    an Azure Active Directory tenant. It uses Azure SignInLogs data and calculates
    the standard deviation for source IPs, applying the 3-sigma rule to detect unusual
    numbers of failed authentication attempts. This activity is significant as it
    may signal an adversary attempting to gain initial access or elevate privileges.
    If confirmed mali
  author: Mauricio Velazco, Gowthamaraj Rajendran, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1110.003
      name: Technique T1110.003
    - id: T1110.004
      name: Technique T1110.004
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/password_spraying_azuread/azuread_signin.log
    description: Azure AD - azure:monitor:aad
    format: auto
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
