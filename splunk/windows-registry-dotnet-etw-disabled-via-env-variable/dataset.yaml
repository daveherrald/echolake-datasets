metadata:
  name: windows-registry-dotnet-etw-disabled-via-env-variable
  version: 6.0.0
  description: The following analytic detects a registry modification that disables
    the ETW for the .NET Framework. It leverages data from the Endpoint.Registry data
    model, specifically monitoring changes to the COMPlus_ETWEnabled registry value
    under the "Environment" registry key path for both user (HKCU\Environment) and
    machine (HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\Environment) scopes.
    This activity is significant because disabling ETW can allow attackers to evade
    Endpoint Detection and Res
  author: Nasreddine Bencherchali, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-registry-abuse
  - windows-defense-evasion-tactics
  mitre_attack:
    techniques:
    - id: T1562.006
      name: Technique T1562.006
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.006/dotnet_etw_bypass/dotnet_etw_bypass.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
