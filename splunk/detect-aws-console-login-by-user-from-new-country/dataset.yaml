metadata:
  name: detect-aws-console-login-by-user-from-new-country
  version: 7.0.0
  description: The following analytic identifies AWS console login events by users
    from a new country. It leverages AWS CloudTrail events and compares them against
    a lookup file of previously seen users and their login locations. This activity
    is significant because logins from new countries can indicate potential unauthorized
    access or compromised accounts. If confirmed malicious, this could lead to unauthorized
    access to AWS resources, data exfiltration, or further exploitation within the
    AWS environment.
  author: Bhavin Patel, Eric McGinnis Splunk
  tags:
  - hunting
  - splunk-security-content
  - suspicious-aws-login-activities
  - suspicious-cloud-authentication-activities
  - aws-identity-and-access-management-account-takeover
  mitre_attack:
    techniques:
    - id: T1535
      name: Technique T1535
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/suspicious_behaviour/abnormally_high_cloud_instances_launched/cloudtrail_behavioural_detections.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
