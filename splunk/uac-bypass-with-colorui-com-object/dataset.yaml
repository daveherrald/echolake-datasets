metadata:
  name: uac-bypass-with-colorui-com-object
  version: 8.0.0
  description: The following analytic detects a potential UAC bypass using the colorui.dll
    COM Object. It leverages Sysmon EventCode 7 to identify instances where colorui.dll
    is loaded by a process other than colorcpl.exe, excluding common system directories.
    This activity is significant because UAC bypass techniques are often used by malware,
    such as LockBit ransomware, to gain elevated privileges without user consent.
    If confirmed malicious, this could allow an attacker to execute code with higher
    privileges
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - ransomware
  - lockbit-ransomware
  mitre_attack:
    techniques:
    - id: T1218.003
      name: Technique T1218.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1546.015/uac_colorui/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
