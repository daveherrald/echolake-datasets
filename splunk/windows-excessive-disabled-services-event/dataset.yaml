metadata:
  name: windows-excessive-disabled-services-event
  version: 9.0.0
  description: The following analytic identifies an excessive number of system events
    where services are modified from start to disabled. It leverages Windows Event
    Logs (EventCode 7040) to detect multiple service state changes on a single host.
    This activity is significant as it may indicate an adversary attempting to disable
    security applications or other critical services, potentially leading to defense
    evasion or destructive actions. If confirmed malicious, this behavior could allow
    attackers to disable se
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - cisa-aa23-347a
  - compromised-windows-host
  - windows-defense-evasion-tactics
  mitre_attack:
    techniques:
    - id: T1562.001
      name: Technique T1562.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.001/windows_excessive_disabled_services_event/windows-xml.log
    description: XmlWinEventLog:System - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
