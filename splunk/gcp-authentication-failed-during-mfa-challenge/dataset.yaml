metadata:
  name: gcp-authentication-failed-during-mfa-challenge
  version: 9.0.0
  description: The following analytic detects failed authentication attempts during
    the Multi-Factor Authentication (MFA) challenge on a Google Cloud Platform (GCP)
    tenant. It uses Google Workspace login failure events to identify instances where
    MFA methods were challenged but not successfully completed. This activity is significant
    as it may indicate an adversary attempting to access an account with compromised
    credentials despite MFA protection. If confirmed malicious, this could lead to
    unauthorized access
  author: Bhavin Patel, Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - gcp-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    - id: T1586.003
      name: Technique T1586.003
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/gcp_failed_mfa/gws_login.log
    description: gws:reports:login - gws:reports:login
    format: auto
    schema: raw
    sourcetype: gws:reports:login
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
