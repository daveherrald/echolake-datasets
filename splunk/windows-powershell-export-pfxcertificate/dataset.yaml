metadata:
  name: windows-powershell-export-pfxcertificate
  version: 10.0.0
  description: The following analytic detects the use of the PowerShell cmdlet `export-pfxcertificate`
    by leveraging Script Block Logging. This activity is significant as it may indicate
    an adversary attempting to exfiltrate certificates from the Windows Certificate
    Store. Monitoring this behavior is crucial for identifying potential certificate
    theft, which can lead to unauthorized access and impersonation attacks. If confirmed
    malicious, this activity could allow attackers to compromise secure communications
  author: Michael Haag, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - scattered-lapsus$-hunters
  - windows-certificate-services
  - water-gamayun
  mitre_attack:
    techniques:
    - id: T1552.004
      name: Technique T1552.004
    - id: T1649
      name: Technique T1649
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1649/atomic_red_team/4104_export_pfxcertificate.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
