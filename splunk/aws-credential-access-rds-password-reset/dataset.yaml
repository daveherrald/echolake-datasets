metadata:
  name: aws-credential-access-rds-password-reset
  version: 9.0.0
  description: The following analytic detects the resetting of the master user password
    for an Amazon RDS DB instance. It leverages AWS CloudTrail logs to identify events
    where the `ModifyDBInstance` API call includes a new `masterUserPassword` parameter.
    This activity is significant because unauthorized password resets can grant attackers
    access to sensitive data stored in production databases, such as credit card information,
    PII, and healthcare data. If confirmed malicious, this could lead to data breaches,
  author: Gowthamaraj Rajendran, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-identity-and-access-management-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1110
      name: Technique T1110
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.002/aws_rds_password_reset/aws_cloudtrail_events.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
