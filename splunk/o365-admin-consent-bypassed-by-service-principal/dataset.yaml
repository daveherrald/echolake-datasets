metadata:
  name: o365-admin-consent-bypassed-by-service-principal
  version: 6.0.0
  description: The following analytic identifies instances where a service principal
    in Office 365 Azure Active Directory assigns app roles without standard admin
    consent. It leverages `o365_management_activity` logs, specifically focusing on
    the 'Add app role assignment to service principal' operation. This activity is
    significant for SOCs as it may indicate a bypass of critical administrative controls,
    potentially leading to unauthorized access or privilege escalation. If confirmed
    malicious, this could allo
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - office-365-persistence-mechanisms
  mitre_attack:
    techniques:
    - id: T1098.003
      name: Technique T1098.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1098.003/o365_bypass_admin_consent/o365_bypass_admin_consent.log
    description: o365 - o365:management:activity
    format: text
    schema: raw
    sourcetype: o365:management:activity
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
