metadata:
  name: malicious-powershell-process-encoded-command
  version: 18.0.0
  description: The following analytic detects the use of the EncodedCommand parameter
    in PowerShell processes. It leverages Endpoint Detection and Response (EDR) data
    to identify variations of the EncodedCommand parameter, including shortened forms
    and different command switch types. This activity is significant because adversaries
    often use encoded commands to obfuscate malicious scripts, making detection harder.
    If confirmed malicious, this behavior could allow attackers to execute hidden
    code, potentially l
  author: David Dorsey, Michael Haag, Splunk, SirDuckly, GitHub Community
  tags:
  - hunting
  - splunk-security-content
  - cisa-aa22-320a
  - hermetic-wiper
  - sandworm-tools
  mitre_attack:
    techniques:
    - id: T1027
      name: Technique T1027
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1027/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
