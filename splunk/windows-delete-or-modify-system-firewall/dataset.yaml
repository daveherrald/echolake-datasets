metadata:
  name: windows-delete-or-modify-system-firewall
  version: 8.0.0
  description: The following analytic identifies 'netsh' processes that delete or
    modify firewall configurations. It leverages data from Endpoint Detection and
    Response (EDR) agents, focusing on command-line executions containing specific
    keywords. This activity is significant because it can indicate malware, such as
    NJRAT, attempting to alter firewall settings to evade detection or remove traces.
    If confirmed malicious, this behavior could allow an attacker to disable security
    measures, facilitating further c
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - njrat
  - shrinklocker
  mitre_attack:
    techniques:
    - id: T1562.004
      name: Technique T1562.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562.004/njrat_delete_firewall/njrat_delete_firewall.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
