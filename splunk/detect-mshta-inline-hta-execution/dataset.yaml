metadata:
  name: detect-mshta-inline-hta-execution
  version: 18.0.0
  description: The following analytic detects the execution of "mshta.exe" with inline
    protocol handlers such as "JavaScript", "VBScript", and "About". It leverages
    data from Endpoint Detection and Response (EDR) agents, focusing on command-line
    arguments and process details. This activity is significant because mshta.exe
    can be exploited to execute malicious scripts, potentially leading to unauthorized
    code execution. If confirmed malicious, this could allow an attacker to execute
    arbitrary code, escalate pri
  author: Bhavin Patel, Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-windows-host
  - gozi-malware
  - living-off-the-land
  mitre_attack:
    techniques:
    - id: T1218.005
      name: Technique T1218.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.005/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
