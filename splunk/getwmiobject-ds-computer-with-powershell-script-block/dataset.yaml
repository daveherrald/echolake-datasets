metadata:
  name: getwmiobject-ds-computer-with-powershell-script-block
  version: 8.0.0
  description: The following analytic detects the execution of the `Get-WmiObject`
    cmdlet with the `DS_Computer` class parameter via PowerShell Script Block Logging
    (EventCode=4104). This detection leverages script block text to identify queries
    targeting domain computers using WMI. Monitoring this activity is crucial as adversaries
    and Red Teams may use it for Active Directory Discovery and situational awareness.
    If confirmed malicious, this behavior could allow attackers to map out domain
    computers, facilita
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1018
      name: Technique T1018
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/sbl_xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
