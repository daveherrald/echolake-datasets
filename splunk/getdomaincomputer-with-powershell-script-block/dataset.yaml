metadata:
  name: getdomaincomputer-with-powershell-script-block
  version: 8.0.0
  description: The following analytic detects the execution of the `Get-DomainComputer`
    commandlet using PowerShell Script Block Logging (EventCode=4104). This commandlet
    is part of PowerView, a tool often used for enumerating domain computers within
    Windows environments. The detection leverages script block text analysis to identify
    this specific command. Monitoring this activity is crucial as it can indicate
    an adversary's attempt to gather information about domain computers, which is
    a common step in Active
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1018
      name: Technique T1018
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/sbl_xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
