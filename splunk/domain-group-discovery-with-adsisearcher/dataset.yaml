metadata:
  name: domain-group-discovery-with-adsisearcher
  version: 10.0.0
  description: The following analytic detects the use of the `[Adsisearcher]` type
    accelerator in PowerShell to query Active Directory for domain groups. It leverages
    PowerShell Script Block Logging (EventCode=4104) to identify specific script blocks
    containing `[adsisearcher]` and group-related queries. This activity is significant
    as it may indicate an attempt by adversaries or Red Teams to enumerate domain
    groups for situational awareness and Active Directory discovery. If confirmed
    malicious, this behavior
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - scattered-lapsus$-hunters
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1069.002
      name: Technique T1069.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1069.002/domain_group_discovery_with_adsisearcher/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
