metadata:
  name: windows-curl-upload-to-remote-destination
  version: 14.0.0
  description: The following analytic detects the use of Windows Curl.exe to upload
    a file to a remote destination. It identifies command-line arguments such as `-T`,
    `--upload-file`, `-d`, `--data`, and `-F` in process execution logs. This activity
    is significant because adversaries may use Curl to exfiltrate data or upload malicious
    payloads. If confirmed malicious, this could lead to data breaches or further
    compromise of the system. Analysts should review parallel processes and network
    logs to determine if
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - cisco-network-visibility-module-analytics
  - compromised-windows-host
  - ingress-tool-transfer
  mitre_attack:
    techniques:
    - id: T1105
      name: Technique T1105
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1105/atomic_red_team/windows-sysmon_curl_upload.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/cisco_network_visibility_module/cisco_nvm_flowdata/nvm_flowdata.log
    description: not_applicable - cisco:nvm:flowdata
    format: text
    schema: raw
    sourcetype: cisco:nvm:flowdata
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
