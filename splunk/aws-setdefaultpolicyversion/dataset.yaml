metadata:
  name: aws-setdefaultpolicyversion
  version: 7.0.0
  description: The following analytic detects when a user sets a default policy version
    in AWS. It leverages AWS CloudTrail logs to identify the `SetDefaultPolicyVersion`
    event from the IAM service. This activity is significant because attackers may
    exploit this technique for privilege escalation, especially if previous policy
    versions grant more extensive permissions than the current one. If confirmed malicious,
    this could allow an attacker to gain elevated access to AWS resources, potentially
    leading to unau
  author: Bhavin Patel, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-iam-privilege-escalation
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078/aws_setdefaultpolicyversion/aws_cloudtrail_events.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
    sourcetype: aws:cloudtrail
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
