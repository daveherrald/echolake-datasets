metadata:
  name: azure-ad-block-user-consent-for-risky-apps-disabled
  version: 9.0.0
  description: The following analytic detects when the risk-based step-up consent
    security setting in Azure AD is disabled. It monitors Azure Active Directory logs
    for the "Update authorization policy" operation, specifically changes to the "AllowUserConsentForRiskyApps"
    setting. This activity is significant because disabling this feature can expose
    the organization to OAuth phishing threats by allowing users to grant consent
    to potentially malicious applications. If confirmed malicious, attackers could
    gain u
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1562
      name: Technique T1562
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1562/azuread_disable_blockconsent_for_riskapps/azuread_disable_blockconsent_for_riskapps.log
    description: Azure Ad - azure:monitor:aad
    format: auto
    schema: raw
    sourcetype: azure:monitor:aad
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
