metadata:
  name: o365-file-permissioned-application-consent-granted-by-user
  version: 6.0.0
  description: 'The following analytic identifies instances where a user in the Office
    365 environment grants consent to an application requesting file permissions for
    OneDrive or SharePoint. It leverages O365 audit logs, focusing on OAuth application
    consent events. This activity is significant because granting such permissions
    can allow applications to access, modify, or delete files, posing a risk if the
    application is malicious or overly permissive. If confirmed malicious, this could
    lead to data breaches, '
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - office-365-account-takeover
  mitre_attack:
    techniques:
    - id: T1528
      name: Technique T1528
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1528/o365_user_consent_file_permissions/o365_user_consent_file_permissions.log
    description: o365 - o365:management:activity
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
