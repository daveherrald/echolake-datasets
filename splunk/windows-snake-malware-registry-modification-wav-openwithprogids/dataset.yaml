metadata:
  name: windows-snake-malware-registry-modification-wav-openwithprogids
  version: 8.0.0
  description: The following analytic identifies modifications to the registry path
    .wav\\OpenWithProgIds, associated with the Snake Malware campaign. It leverages
    data from the Endpoint.Registry datamodel to detect changes in this specific registry
    location. This activity is significant because Snake's WerFault.exe uses this
    registry path to decrypt an encrypted blob containing critical components like
    the AES key, IV, and paths for its kernel driver and loader. If confirmed malicious,
    this could allow the at
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - snake-malware
  mitre_attack:
    techniques:
    - id: T1112
      name: Technique T1112
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/snakemalware/snake_malware_regblob-windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
