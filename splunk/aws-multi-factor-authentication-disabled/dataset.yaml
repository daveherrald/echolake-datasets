metadata:
  name: aws-multi-factor-authentication-disabled
  version: 8.0.0
  description: The following analytic detects attempts to disable multi-factor authentication
    (MFA) for an AWS IAM user. It leverages AWS CloudTrail logs to identify events
    where MFA devices are deleted or deactivated. This activity is significant because
    disabling MFA can indicate an adversary attempting to weaken account security,
    potentially to maintain persistence using a compromised account. If confirmed
    malicious, this action could allow attackers to retain access to the AWS environment
    without detection
  author: Bhavin Patel, Splunk
  tags:
  - ttp
  - splunk-security-content
  - aws-identity-and-access-management-account-takeover
  - scattered-lapsus$-hunters
  mitre_attack:
    techniques:
    - id: T1556.006
      name: Technique T1556.006
    - id: T1586.003
      name: Technique T1586.003
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/aws_mfa_disabled/cloudtrail.json
    description: aws_cloudtrail - aws:cloudtrail
    format: jsonl
    schema: raw
    sourcetype: aws:cloudtrail
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
