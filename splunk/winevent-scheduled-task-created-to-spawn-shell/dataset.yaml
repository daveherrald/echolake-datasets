metadata:
  name: winevent-scheduled-task-created-to-spawn-shell
  version: 16.0.0
  description: 'The following analytic detects the creation of scheduled tasks designed
    to execute commands using native Windows shells like PowerShell, Cmd, Wscript,
    or Cscript. It leverages Windows Security EventCode 4698 to identify when such
    tasks are registered. This activity is significant as it may indicate an attempt
    to establish persistence or execute malicious commands on a system. If confirmed
    malicious, this could allow an attacker to maintain access, execute arbitrary
    code, or escalate privileges, '
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - cisa-aa22-257a
  - china-nexus-threat-activity
  - compromised-windows-host
  mitre_attack:
    techniques:
    - id: T1053.005
      name: Technique T1053.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/winevent_scheduled_task_created_to_spawn_shell/windows-xml.log
    description: XmlWinEventLog:Security - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
