metadata:
  name: powershell-script-block-with-url-chain
  version: 7.0.0
  description: The following analytic identifies suspicious PowerShell script execution
    via EventCode 4104 that contains multiple URLs within a function or array. It
    leverages PowerShell operational logs to detect script blocks with embedded URLs,
    often indicative of obfuscated scripts or those attempting to download secondary
    payloads. This activity is significant as it may signal an attempt to execute
    malicious code or download additional malware. If confirmed malicious, this could
    lead to code execution, fu
  author: Steven Dick
  tags:
  - ttp
  - splunk-security-content
  - malicious-powershell
  - hellcat-ransomware
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    - id: T1105
      name: Technique T1105
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/gootloader/partial_ttps/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
