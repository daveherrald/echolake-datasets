metadata:
  name: o365-multi-source-failed-authentications-spike
  version: 8.0.0
  description: The following analytic identifies a spike in failed authentication
    attempts within an Office 365 environment, indicative of a potential distributed
    password spraying attack. It leverages UserLoginFailed events from O365 Management
    Activity logs, focusing on ErrorNumber 50126. This detection is significant as
    it highlights attempts to bypass security controls using multiple IP addresses
    and user agents. If confirmed malicious, this activity could lead to unauthorized
    access, data breaches, privil
  author: Mauricio Velazco, Splunk
  tags:
  - hunting
  - splunk-security-content
  - office-365-account-takeover
  - nobelium-group
  mitre_attack:
    techniques:
    - id: T1110.003
      name: Technique T1110.003
    - id: T1110.004
      name: Technique T1110.004
    - id: T1586.003
      name: Technique T1586.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1110.003/o365_distributed_spray/o365_distributed_spray.log
    description: o365 - o365:management:activity
    format: text
    schema: raw
    sourcetype: o365:management:activity
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
