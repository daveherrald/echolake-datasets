metadata:
  name: detect-mshta-renamed
  version: 11.0.0
  description: The following analytic identifies instances where mshta.exe has been
    renamed and executed. It leverages Endpoint Detection and Response (EDR) data,
    specifically focusing on the original file name field to detect discrepancies.
    This activity is significant because renaming mshta.exe is a common tactic used
    by attackers to evade detection and execute malicious scripts. If confirmed malicious,
    this could allow an attacker to execute arbitrary code, potentially leading to
    system compromise, data exf
  author: Michael Haag, Splunk
  tags:
  - hunting
  - splunk-security-content
  - suspicious-mshta-activity
  - living-off-the-land
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1218.005
      name: Technique T1218.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.005/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
