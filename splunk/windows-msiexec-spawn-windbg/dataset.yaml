metadata:
  name: windows-msiexec-spawn-windbg
  version: 9.0.0
  description: The following analytic identifies the unusual behavior of MSIExec spawning
    WinDBG. It detects this activity by analyzing endpoint telemetry data, specifically
    looking for instances where 'msiexec.exe' is the parent process of 'windbg.exe'.
    This behavior is significant as it may indicate an attempt to debug or tamper
    with system processes, which is uncommon in typical user activity and could signify
    malicious intent. If confirmed malicious, this activity could allow an attacker
    to manipulate or i
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-windows-host
  - darkgate-malware
  mitre_attack:
    techniques:
    - id: T1218.007
      name: Technique T1218.007
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.007/atomic_red_team/windbg_msiexec.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
