metadata:
  name: windows-mstsc-rdp-commandline
  version: 3.0.0
  description: The following analytic detects the use of the mstsc.exe command-line,
    which is commonly used to initiate Remote Desktop Protocol (RDP) connections.
    This detection focuses on instances where mstsc.exe is executed with specific
    parameters that may indicate suspicious or unauthorized remote access attempts.
    Monitoring command-line arguments such as /v:<target> for direct connections or
    /admin for administrative sessions can help identify potential misuse or lateral
    movement within a network.
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - medusa-ransomware
  - windows-rdp-artifacts-and-defense-evasion
  mitre_attack:
    techniques:
    - id: T1021.001
      name: Technique T1021.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1021.001/mstsc_rdp_cmd/mstsc_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
