metadata:
  name: windows-scheduled-task-with-highest-privileges
  version: 12.0.0
  description: The following analytic detects the creation of a new scheduled task
    with the highest execution privileges via Schtasks.exe. It leverages Endpoint
    Detection and Response (EDR) logs to monitor for specific command-line parameters
    ('/rl' and 'highest') in schtasks.exe executions. This activity is significant
    as it is commonly used in AsyncRAT attacks for persistence and privilege escalation.
    If confirmed malicious, this could allow an attacker to maintain persistent access
    and execute tasks with el
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - xworm
  - cisa-aa23-347a
  - scheduled-tasks
  mitre_attack:
    techniques:
    - id: T1053.005
      name: Technique T1053.005
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1053.005/asyncrat_highest_priv_schtasks/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
