metadata:
  name: get-domaintrust-with-powershell-script-block
  version: 8.0.0
  description: The following analytic detects the execution of the Get-DomainTrust
    command from PowerView using PowerShell Script Block Logging (EventCode=4104).
    This method captures the full command sent to PowerShell, allowing for detailed
    inspection. Identifying this activity is significant because it may indicate an
    attempt to gather domain trust information, which is often a precursor to lateral
    movement or privilege escalation. If confirmed malicious, this activity could
    enable an attacker to map trust r
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-discovery
  mitre_attack:
    techniques:
    - id: T1482
      name: Technique T1482
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1059.001/powershell_script_block_logging/domaintrust.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
