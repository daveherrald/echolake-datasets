metadata:
  name: detect-regsvcs-with-network-connection
  version: 12.0.0
  description: 'The following analytic identifies instances of Regsvcs.exe establishing
    a network connection to a public IP address, excluding private IP ranges. This
    detection leverages Sysmon EventID 3 logs to monitor network connections initiated
    by Regsvcs.exe. This activity is significant as Regsvcs.exe, a legitimate Microsoft-signed
    binary, can be exploited to bypass application control mechanisms and establish
    remote Command and Control (C2) channels. If confirmed malicious, this behavior
    could allow an '
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - suspicious-regsvcs-regasm-activity
  - living-off-the-land
  - hellcat-ransomware
  mitre_attack:
    techniques:
    - id: T1218.009
      name: Technique T1218.009
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1218.009/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
