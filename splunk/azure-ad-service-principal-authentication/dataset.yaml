metadata:
  name: azure-ad-service-principal-authentication
  version: 8.0.0
  description: The following analytic identifies authentication events of service
    principals in Azure Active Directory. It leverages the `azure_monitor_aad` data
    source, specifically targeting "Sign-in activity" within ServicePrincipalSignInLogs.
    This detection gathers details such as sign-in frequency, timing, source IPs,
    and accessed resources. Monitoring these events is significant for SOC teams to
    distinguish between normal application authentication and potential anomalies,
    which could indicate compromise
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-account-takeover
  - nobelium-group
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1078.004/azure_ad_service_principal_authentication/azure_ad_service_principal_authentication.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
