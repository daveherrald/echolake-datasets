metadata:
  name: windows-input-capture-using-credential-ui-dll
  version: 8.0.0
  description: The following analytic detects a process loading the credui.dll or
    wincredui.dll module. This detection leverages Sysmon EventCode 7 to identify
    instances where these DLLs are loaded by processes outside typical system directories.
    This activity is significant because adversaries often abuse these modules to
    create fake credential prompts or dump credentials, posing a risk of credential
    theft. If confirmed malicious, this activity could allow attackers to harvest
    user credentials, leading to una
  author: Teoderick Contreras, Splunk
  tags:
  - hunting
  - splunk-security-content
  - brute-ratel-c4
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1056.002
      name: Technique T1056.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/brute_ratel/iso_version_dll_campaign/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
