metadata:
  name: windows-exfiltration-over-c2-via-invoke-restmethod
  version: 10.0.0
  description: The following analytic detects potential data exfiltration using PowerShell's
    Invoke-RestMethod. It leverages PowerShell Script Block Logging to identify scripts
    that attempt to upload files via HTTP POST requests. This activity is significant
    as it may indicate an attacker is exfiltrating sensitive data, such as desktop
    screenshots or files, to an external command and control (C2) server. If confirmed
    malicious, this could lead to data breaches, loss of sensitive information, and
    further compro
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - microsoft-wsus-cve-2025-59287
  - hellcat-ransomware
  - apt37-rustonotto-and-fadestealer
  mitre_attack:
    techniques:
    - id: T1041
      name: Technique T1041
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/winter-vivern/pwh_exfiltration/windows-powershell-xml.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
