metadata:
  name: windows-modify-registry-disableremotedesktopantialias
  version: 8.0.0
  description: The following analytic detects modifications to the Windows registry
    key "DisableRemoteDesktopAntiAlias" with a value set to 0x00000001. This detection
    leverages data from the Endpoint datamodel, specifically monitoring changes in
    the Registry node. This activity is significant as it may indicate the presence
    of DarkGate malware, which alters this registry setting to enhance its remote
    desktop capabilities. If confirmed malicious, this modification could allow an
    attacker to maintain persistence
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - darkgate-malware
  mitre_attack:
    techniques:
    - id: T1112
      name: Technique T1112
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1112/DisableRemoteDesktopAntiAlias/disable_remote_alias.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
