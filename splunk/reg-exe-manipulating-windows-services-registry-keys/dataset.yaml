metadata:
  name: reg-exe-manipulating-windows-services-registry-keys
  version: 12.0.0
  description: The following analytic detects the use of reg.exe to modify registry
    keys associated with Windows services and their configurations. It leverages data
    from Endpoint Detection and Response (EDR) agents, focusing on process names,
    parent processes, and command-line executions. This activity is significant because
    unauthorized changes to service registry keys can indicate an attempt to establish
    persistence or escalate privileges. If confirmed malicious, this could allow an
    attacker to control serv
  author: Rico Valdez, Splunk
  tags:
  - ttp
  - splunk-security-content
  - windows-service-abuse
  - windows-persistence-techniques
  - living-off-the-land
  mitre_attack:
    techniques:
    - id: T1574.011
      name: Technique T1574.011
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1574.011/change_registry_path_service/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
