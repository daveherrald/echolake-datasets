metadata:
  name: windows-sqlservr-spawning-shell
  version: 3.0.0
  description: This analytic detects instances where the sqlservr.exe process spawns
    a command shell (cmd.exe) or PowerShell process. This behavior is often indicative
    of command execution initiated from within the SQL Server process, potentially
    due to exploitation of SQL injection vulnerabilities or the use of extended stored
    procedures like xp_cmdshell.
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - sql-server-abuse
  mitre_attack:
    techniques:
    - id: T1505.001
      name: Technique T1505.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1505.001/simulation/sqlservr-windows_sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
