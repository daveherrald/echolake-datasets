metadata:
  name: winrar-spawning-shell-application
  version: 9.0.0
  description: The following analytic detects the execution of Windows shell processes
    initiated by WinRAR, such as "cmd.exe", "powershell.exe", "certutil.exe", "mshta.exe",
    or "bitsadmin.exe". This detection leverages data from Endpoint Detection and
    Response (EDR) agents, focusing on process and parent process relationships. This
    activity is significant because it may indicate exploitation of the WinRAR CVE-2023-38831
    vulnerability, where malicious scripts are executed from spoofed ZIP archives.
    If confirmed
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - compromised-windows-host
  - winrar-spoofing-attack-cve-2023-38831
  mitre_attack:
    techniques:
    - id: T1105
      name: Technique T1105
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1105/atomic_red_team/winrar.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
