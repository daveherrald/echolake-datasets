metadata:
  name: windows-shell-process-from-crushftp
  version: 2.0.0
  description: 'The following analytic identifies instances where CrushFTP''s service
    process (crushftpservice.exe) spawns shell processes like cmd.exe or powershell.exe.
    This detection leverages data from Endpoint Detection and Response (EDR) agents,
    focusing on process creation events. This activity is significant because CrushFTP
    should not normally spawn interactive shell processes during regular operations.
    If confirmed malicious, this behavior could indicate successful exploitation of
    vulnerabilities like '
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - crushftp-vulnerabilities
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    - id: T1059.003
      name: Technique T1059.003
    - id: T1190
      name: Technique T1190
    - id: T1505
      name: Technique T1505
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/crushftp/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
