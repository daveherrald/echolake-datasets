metadata:
  name: windows-private-keys-discovery
  version: 7.0.0
  description: The following analytic identifies processes that retrieve information
    related to private key files, often used by post-exploitation tools like winpeas.
    This detection leverages data from Endpoint Detection and Response (EDR) agents,
    focusing on command-line executions that search for private key certificates.
    This activity is significant as it indicates potential attempts to locate insecurely
    stored credentials, which adversaries can exploit for privilege escalation, persistence,
    or remote servi
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - windows-post-exploitation
  - prestige-ransomware
  mitre_attack:
    techniques:
    - id: T1552.004
      name: Technique T1552.004
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/winpeas/winpeas_search_private_key/dir-private-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
