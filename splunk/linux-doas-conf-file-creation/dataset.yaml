metadata:
  name: linux-doas-conf-file-creation
  version: 7.0.0
  description: The following analytic detects the creation of the doas.conf file on
    a Linux host. This file is used by the doas utility to allow standard users to
    perform tasks as root, similar to sudo. The detection leverages filesystem data
    from the Endpoint data model, focusing on the creation of the doas.conf file.
    This activity is significant because it can indicate an attempt to gain elevated
    privileges, potentially by an adversary. If confirmed malicious, this could allow
    an attacker to execute commands
  author: Teoderick Contreras, Splunk
  tags:
  - anomaly
  - splunk-security-content
  - linux-privilege-escalation
  - linux-persistence-techniques
  mitre_attack:
    techniques:
    - id: T1548.003
      name: Technique T1548.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1548.003/doas/sysmon_linux.log
    description: Syslog:Linux-Sysmon/Operational - sysmon:linux
    format: auto
    schema: raw
    sourcetype: sysmon:linux
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
