metadata:
  name: windows-papercut-ng-spawn-shell
  version: 9.0.0
  description: The following analytic detects instances where the PaperCut NG application
    (pc-app.exe) spawns a Windows shell, such as cmd.exe or PowerShell. This behavior
    is identified using Endpoint Detection and Response (EDR) telemetry, focusing
    on process creation events where the parent process is pc-app.exe. This activity
    is significant as it may indicate an attacker attempting to gain unauthorized
    access or execute malicious commands on the system. If confirmed malicious, this
    could lead to unauthorize
  author: Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - papercut-mf-ng-vulnerability
  - compromised-windows-host
  mitre_attack:
    techniques:
    - id: T1059
      name: Technique T1059
    - id: T1190
      name: Technique T1190
    - id: T1133
      name: Technique T1133
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1190/papercut/papercutng-app-spawn_windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: auto
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
