metadata:
  name: xsl-script-execution-with-wmic
  version: 8.0.0
  description: The following analytic detects the execution of an XSL script using
    the WMIC process, which is often indicative of malicious activity. It leverages
    data from Endpoint Detection and Response (EDR) agents, focusing on command-line
    executions involving WMIC and XSL files. This behavior is significant as it has
    been associated with the FIN7 group, known for using this technique to execute
    malicious scripts. If confirmed malicious, this activity could allow attackers
    to execute arbitrary code, potent
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - fin7
  - suspicious-wmi-use
  mitre_attack:
    techniques:
    - id: T1220
      name: Technique T1220
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/malware/fin7/fin7_macro_js_1/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
