metadata:
  name: windows-powersploit-gpp-discovery
  version: 10.0.0
  description: The following analytic detects the execution of the Get-GPPPassword
    PowerShell cmdlet, which is used to search for unsecured credentials in Group
    Policy Preferences (GPP). This detection leverages PowerShell Script Block Logging
    to identify specific script block text associated with this cmdlet. Monitoring
    this activity is crucial as it can indicate an attempt to retrieve and decrypt
    stored credentials from SYSVOL, potentially leading to unauthorized access. If
    confirmed malicious, this activity
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - active-directory-privilege-escalation
  mitre_attack:
    techniques:
    - id: T1552.006
      name: Technique T1552.006
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1552.006/powershell_gpp_discovery/win-powershell.log
    description: XmlWinEventLog:Microsoft-Windows-PowerShell/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
