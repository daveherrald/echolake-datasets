metadata:
  name: dns-exfiltration-using-nslookup-app
  version: 10.0.0
  description: The following analytic identifies potential DNS exfiltration using
    the nslookup application. It detects specific command-line parameters such as
    query type (TXT, A, AAAA) and retry options, which are commonly used by attackers
    to exfiltrate data. The detection leverages Endpoint Detection and Response (EDR)
    telemetry, focusing on process execution logs. This activity is significant as
    it may indicate an attempt to communicate with a Command and Control (C2) server
    or exfiltrate sensitive data. I
  author: Teoderick Contreras, Splunk, Wouter Jansen
  tags:
  - ttp
  - splunk-security-content
  - suspicious-dns-traffic
  - dynamic-dns
  - data-exfiltration
  mitre_attack:
    techniques:
    - id: T1048
      name: Technique T1048
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1048.003/nslookup_exfil/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
