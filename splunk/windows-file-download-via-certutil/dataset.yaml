metadata:
  name: windows-file-download-via-certutil
  version: 3.0.0
  description: 'The following analytic detects the use of `certutil.exe` to download
    files using the `-URL`, `-urlcache` or ''-verifyctl'' arguments. This behavior
    is identified by monitoring command-line executions for these specific arguments
    via Endpoint Detection and Response (EDR) telemetry. This activity is significant
    because `certutil.exe` is a legitimate tool often abused by attackers to download
    and execute malicious payloads. If confirmed malicious, this could allow an attacker
    to download and execute '
  author: Nasreddine Bencherchali, Michael Haag, Splunk
  tags:
  - ttp
  - splunk-security-content
  - living-off-the-land
  - ingress-tool-transfer
  - proxynotshell
  mitre_attack:
    techniques:
    - id: T1105
      name: Technique T1105
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1105/atomic_red_team/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/cisco_network_visibility_module/cisco_nvm_flowdata/nvm_flowdata.log
    description: not_applicable - cisco:nvm:flowdata
    format: text
    schema: raw
    sourcetype: cisco:nvm:flowdata
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
