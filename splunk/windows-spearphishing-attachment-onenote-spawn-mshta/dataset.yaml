metadata:
  name: windows-spearphishing-attachment-onenote-spawn-mshta
  version: 9.0.0
  description: 'The following analytic detects OneNote spawning `mshta.exe`, a behavior
    often associated with spearphishing attacks. It leverages data from Endpoint Detection
    and Response (EDR) agents, focusing on process creation events where OneNote is
    the parent process. This activity is significant as it is commonly used by malware
    families like TA551, AsyncRat, Redline, and DCRAT to execute malicious scripts.
    If confirmed malicious, this could allow attackers to execute arbitrary code,
    potentially leading '
  author: Teoderick Contreras, Splunk
  tags:
  - ttp
  - splunk-security-content
  - spearphishing-attachments
  - compromised-windows-host
  - asyncrat
  mitre_attack:
    techniques:
    - id: T1566.001
      name: Technique T1566.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1566.001/onenote_spear_phishing/sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
