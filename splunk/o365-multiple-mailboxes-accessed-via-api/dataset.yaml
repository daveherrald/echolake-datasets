metadata:
  name: o365-multiple-mailboxes-accessed-via-api
  version: 7.0.0
  description: The following analytic detects when a high number of Office 365 Exchange
    mailboxes are accessed via API (Microsoft Graph API or Exchange Web Services)
    within a short timeframe. It leverages 'MailItemsAccessed' operations in Exchange,
    using AppId and regex to identify API interactions. This activity is significant
    as it may indicate unauthorized mass email access, potentially signaling data
    exfiltration or account compromise. If confirmed malicious, attackers could gain
    access to sensitive inform
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - office-365-collection-techniques
  - nobelium-group
  mitre_attack:
    techniques:
    - id: T1114.002
      name: Technique T1114.002
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1114.002/o365_multiple_mailboxes_accessed_via_api/o365_multiple_mailboxes_accessed_via_api.log
    description: o365 - o365:management:activity
    format: text
    schema: raw
    sourcetype: o365:management:activity
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
