metadata:
  name: azure-ad-admin-consent-bypassed-by-service-principal
  version: 9.0.0
  description: The following analytic identifies instances where a service principal
    in Azure Active Directory assigns app roles without standard admin consent. It
    uses Entra ID logs from the `azure_monitor_aad` data source, focusing on the "Add
    app role assignment to service principal" operation. This detection is significant
    as it highlights potential bypasses of critical administrative consent processes,
    which could lead to unauthorized privileges being granted. If confirmed malicious,
    this activity could a
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-privilege-escalation
  - nobelium-group
  mitre_attack:
    techniques:
    - id: T1098.003
      name: Technique T1098.003
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1098.003/azure_ad_bypass_admin_consent/azure_ad_bypass_admin_consent.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
