metadata:
  name: windows-powershell-process-with-malicious-string
  version: 4.0.0
  description: The following analytic detects the execution of multiple offensive
    toolkits and commands through the process execution datamodel. This method captures
    commands given directly to powershell.exe, allowing for the identification of
    suspicious activities including several well-known tools used for credential theft,
    lateral movement, and persistence. If confirmed malicious, this could lead to
    unauthorized access, privilege escalation, and potential compromise of sensitive
    information within the envir
  author: Steven Dick
  tags:
  - ttp
  - splunk-security-content
  - malicious-powershell
  mitre_attack:
    techniques:
    - id: T1059.001
      name: Technique T1059.001
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1087.002/AD_discovery/windows-sysmon.log
    description: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational - XmlWinEventLog
    format: text
    schema: raw
    sourcetype: XmlWinEventLog
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
