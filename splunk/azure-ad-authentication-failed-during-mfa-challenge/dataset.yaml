metadata:
  name: azure-ad-authentication-failed-during-mfa-challenge
  version: 10.0.0
  description: The following analytic identifies failed authentication attempts against
    an Azure AD tenant during the Multi-Factor Authentication (MFA) challenge, specifically
    flagged by error code 500121. It leverages Azure AD SignInLogs to detect these
    events. This activity is significant as it may indicate an adversary attempting
    to authenticate using compromised credentials on an account with MFA enabled.
    If confirmed malicious, this could suggest an ongoing effort to bypass MFA protections,
    potentially le
  author: Mauricio Velazco, Gowthamaraj Rajendran, Splunk, 0xC0FFEEEE
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1078.004
      name: Technique T1078.004
    - id: T1586.003
      name: Technique T1586.003
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/azuread/azure-audit.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
