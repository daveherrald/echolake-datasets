metadata:
  name: azure-ad-multiple-denied-mfa-requests-for-user
  version: 9.0.0
  description: The following analytic detects an unusually high number of denied Multi-Factor
    Authentication (MFA) requests for a single user within a 10-minute window, specifically
    when more than nine MFA prompts are declined. It leverages Azure Active Directory
    (Azure AD) sign-in logs, focusing on "Sign-in activity" events with error code
    500121 and additional details indicating "MFA denied; user declined the authentication."
    This behavior is significant as it may indicate a targeted attack or account compro
  author: Mauricio Velazco, Splunk
  tags:
  - ttp
  - splunk-security-content
  - azure-active-directory-account-takeover
  mitre_attack:
    techniques:
    - id: T1621
      name: Technique T1621
    tactics: []
files:
  bundled: []
  references:
  - uri: https://media.githubusercontent.com/media/splunk/attack_data/master/datasets/attack_techniques/T1621/azure_ad_multiple_denied_mfa_requests/azure_ad_multiple_denied_mfa_requests.log
    description: Azure AD - azure:monitor:aad
    format: text
    schema: raw
defaults:
  replay:
    delta_factor: 1.0
    base_time: earliest
    target_time: now-1h
  schema: raw
